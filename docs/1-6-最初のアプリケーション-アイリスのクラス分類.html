<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Pythonで始める機械学習の学習</title>
  <meta name="description" content="Pythonで始める機械学習の学習">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Pythonで始める機械学習の学習" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Pythonで始める機械学習の学習" />
  
  
  

<meta name="author" content="R. Ito">


<meta name="date" content="2018-03-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="1-5-python-2-vs-python-3.html">
<link rel="next" href="2-教師あり学習-1.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #ffffff; color: #1f1c1b; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #ffffff; color: #a0a0a0; border-right: 1px solid #a0a0a0; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #1f1c1b; background-color: #ffffff; }
code > span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code > span.dt { color: #0057ae; } /* DataType */
code > span.dv { color: #b08000; } /* DecVal */
code > span.bn { color: #b08000; } /* BaseN */
code > span.fl { color: #b08000; } /* Float */
code > span.cn { color: #aa5500; } /* Constant */
code > span.ch { color: #924c9d; } /* Char */
code > span.sc { color: #3daee9; } /* SpecialChar */
code > span.st { color: #bf0303; } /* String */
code > span.vs { color: #bf0303; } /* VerbatimString */
code > span.ss { color: #ff5500; } /* SpecialString */
code > span.im { color: #ff5500; } /* Import */
code > span.co { color: #898887; } /* Comment */
code > span.do { color: #607880; } /* Documentation */
code > span.an { color: #ca60ca; } /* Annotation */
code > span.cv { color: #0095ff; } /* CommentVar */
code > span.ot { color: #006e28; } /* Other */
code > span.fu { color: #644a9b; } /* Function */
code > span.va { color: #0057ae; } /* Variable */
code > span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code > span.op { color: #1f1c1b; } /* Operator */
code > span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code > span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code > span.pp { color: #006e28; } /* Preprocessor */
code > span.at { color: #0057ae; } /* Attribute */
code > span.re { color: #0057ae; } /* RegionMarker */
code > span.in { color: #b08000; } /* Information */
code > span.wa { color: #bf0303; } /* Warning */
code > span.al { color: #bf0303; font-weight: bold; } /* Alert */
code > span.er { color: #bf0303; text-decoration: underline; } /* Error */
code > span. { color: #1f1c1b; } /* Normal */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>まえおき</a><ul>
<li class="chapter" data-level="" data-path="方針とか.html"><a href="方針とか.html"><i class="fa fa-check"></i>方針とか</a></li>
<li class="chapter" data-level="" data-path="執筆環境とか.html"><a href="執筆環境とか.html"><i class="fa fa-check"></i>執筆環境とか</a><ul>
<li class="chapter" data-level="" data-path="執筆環境とか.html"><a href="執筆環境とか.html#執筆環境の使い方"><i class="fa fa-check"></i>執筆環境の使い方</a></li>
<li class="chapter" data-level="" data-path="執筆環境とか.html"><a href="執筆環境とか.html#r-sessioninfo"><i class="fa fa-check"></i>R sessionInfo</a></li>
<li class="chapter" data-level="" data-path="執筆環境とか.html"><a href="執筆環境とか.html#python環境"><i class="fa fa-check"></i>Python環境</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="1-はじめに.html"><a href="1-はじめに.html"><i class="fa fa-check"></i><b>1</b> はじめに</a><ul>
<li class="chapter" data-level="1.1" data-path="1-1-なぜ機械学習なのか.html"><a href="1-1-なぜ機械学習なのか.html"><i class="fa fa-check"></i><b>1.1</b> なぜ機械学習なのか</a><ul>
<li class="chapter" data-level="1.1.1" data-path="1-1-なぜ機械学習なのか.html"><a href="1-1-なぜ機械学習なのか.html#機械学習で解決可能な問題"><i class="fa fa-check"></i><b>1.1.1</b> 機械学習で解決可能な問題</a></li>
<li class="chapter" data-level="1.1.2" data-path="1-1-なぜ機械学習なのか.html"><a href="1-1-なぜ機械学習なのか.html#タスクを知りデータを知る"><i class="fa fa-check"></i><b>1.1.2</b> タスクを知り、データを知る</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-2-なぜpythonなのか.html"><a href="1-2-なぜpythonなのか.html"><i class="fa fa-check"></i><b>1.2</b> なぜPythonなのか？</a></li>
<li class="chapter" data-level="1.3" data-path="1-3-scikit-learn.html"><a href="1-3-scikit-learn.html"><i class="fa fa-check"></i><b>1.3</b> scikit-learn</a><ul>
<li class="chapter" data-level="1.3.1" data-path="1-3-scikit-learn.html"><a href="1-3-scikit-learn.html#インストール"><i class="fa fa-check"></i><b>1.3.1</b> インストール</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1-4-必要なライブラリとツール.html"><a href="1-4-必要なライブラリとツール.html"><i class="fa fa-check"></i><b>1.4</b> 必要なライブラリとツール</a></li>
<li class="chapter" data-level="1.5" data-path="1-5-python-2-vs-python-3.html"><a href="1-5-python-2-vs-python-3.html"><i class="fa fa-check"></i><b>1.5</b> Python 2 vs. Python 3</a></li>
<li class="chapter" data-level="1.6" data-path="1-6-最初のアプリケーション-アイリスのクラス分類.html"><a href="1-6-最初のアプリケーション-アイリスのクラス分類.html"><i class="fa fa-check"></i><b>1.6</b> 最初のアプリケーション: アイリスのクラス分類</a><ul>
<li class="chapter" data-level="1.6.1" data-path="1-6-最初のアプリケーション-アイリスのクラス分類.html"><a href="1-6-最初のアプリケーション-アイリスのクラス分類.html#データを読む"><i class="fa fa-check"></i><b>1.6.1</b> データを読む</a></li>
<li class="chapter" data-level="1.6.2" data-path="1-6-最初のアプリケーション-アイリスのクラス分類.html"><a href="1-6-最初のアプリケーション-アイリスのクラス分類.html#成功度合いの測定-訓練データとテストデータ"><i class="fa fa-check"></i><b>1.6.2</b> 成功度合いの測定: 訓練データとテストデータ</a></li>
<li class="chapter" data-level="1.6.3" data-path="1-6-最初のアプリケーション-アイリスのクラス分類.html"><a href="1-6-最初のアプリケーション-アイリスのクラス分類.html#最初にすべきこと-データを良く観察する"><i class="fa fa-check"></i><b>1.6.3</b> 最初にすべきこと: データを良く観察する</a></li>
<li class="chapter" data-level="1.6.4" data-path="1-6-最初のアプリケーション-アイリスのクラス分類.html"><a href="1-6-最初のアプリケーション-アイリスのクラス分類.html#最初のモデル-k-最近傍法"><i class="fa fa-check"></i><b>1.6.4</b> 最初のモデル: k-最近傍法</a></li>
<li class="chapter" data-level="1.6.5" data-path="1-6-最初のアプリケーション-アイリスのクラス分類.html"><a href="1-6-最初のアプリケーション-アイリスのクラス分類.html#予測を行う"><i class="fa fa-check"></i><b>1.6.5</b> 予測を行う</a></li>
<li class="chapter" data-level="1.6.6" data-path="1-6-最初のアプリケーション-アイリスのクラス分類.html"><a href="1-6-最初のアプリケーション-アイリスのクラス分類.html#モデルの評価"><i class="fa fa-check"></i><b>1.6.6</b> モデルの評価</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-教師あり学習-1.html"><a href="2-教師あり学習-1.html"><i class="fa fa-check"></i><b>2</b> 教師あり学習 (1)</a><ul>
<li class="chapter" data-level="2.1" data-path="2-1-クラス分類と回帰.html"><a href="2-1-クラス分類と回帰.html"><i class="fa fa-check"></i><b>2.1</b> クラス分類と回帰</a></li>
<li class="chapter" data-level="2.2" data-path="2-2-汎化過剰適合適合不足.html"><a href="2-2-汎化過剰適合適合不足.html"><i class="fa fa-check"></i><b>2.2</b> 汎化、過剰適合、適合不足</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-2-汎化過剰適合適合不足.html"><a href="2-2-汎化過剰適合適合不足.html#モデルの複雑さとデータセットの大きさ"><i class="fa fa-check"></i><b>2.2.1</b> モデルの複雑さとデータセットの大きさ</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-3-教師あり機械学習アルゴリズム.html"><a href="2-3-教師あり機械学習アルゴリズム.html"><i class="fa fa-check"></i><b>2.3</b> 教師あり機械学習アルゴリズム</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-3-教師あり機械学習アルゴリズム.html"><a href="2-3-教師あり機械学習アルゴリズム.html#サンプルデータセット"><i class="fa fa-check"></i><b>2.3.1</b> サンプルデータセット</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-4-アルゴリズム1-k-最近傍法.html"><a href="2-4-アルゴリズム1-k-最近傍法.html"><i class="fa fa-check"></i><b>2.4</b> アルゴリズム1 <span class="math inline">\(k\)</span>-最近傍法</a><ul>
<li class="chapter" data-level="2.4.1" data-path="2-4-アルゴリズム1-k-最近傍法.html"><a href="2-4-アルゴリズム1-k-最近傍法.html#k-最近傍法によるクラス分類"><i class="fa fa-check"></i><b>2.4.1</b> <span class="math inline">\(k\)</span>-最近傍法によるクラス分類</a></li>
<li class="chapter" data-level="2.4.2" data-path="2-4-アルゴリズム1-k-最近傍法.html"><a href="2-4-アルゴリズム1-k-最近傍法.html#kneighborsclassifierの解析"><i class="fa fa-check"></i><b>2.4.2</b> KNeighborsClassifierの解析</a></li>
<li class="chapter" data-level="2.4.3" data-path="2-4-アルゴリズム1-k-最近傍法.html"><a href="2-4-アルゴリズム1-k-最近傍法.html#k-近傍回帰"><i class="fa fa-check"></i><b>2.4.3</b> <span class="math inline">\(k\)</span>-近傍回帰</a></li>
<li class="chapter" data-level="2.4.4" data-path="2-4-アルゴリズム1-k-最近傍法.html"><a href="2-4-アルゴリズム1-k-最近傍法.html#kneighborsregressorの解析"><i class="fa fa-check"></i><b>2.4.4</b> KNeighborsRegressorの解析</a></li>
<li class="chapter" data-level="2.4.5" data-path="2-4-アルゴリズム1-k-最近傍法.html"><a href="2-4-アルゴリズム1-k-最近傍法.html#利点と欠点とパラメータ"><i class="fa fa-check"></i><b>2.4.5</b> 利点と欠点とパラメータ</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-5-アルゴリズム2-線形モデル.html"><a href="2-5-アルゴリズム2-線形モデル.html"><i class="fa fa-check"></i><b>2.5</b> アルゴリズム2 線形モデル</a><ul>
<li class="chapter" data-level="2.5.1" data-path="2-5-アルゴリズム2-線形モデル.html"><a href="2-5-アルゴリズム2-線形モデル.html#線形モデルによる回帰"><i class="fa fa-check"></i><b>2.5.1</b> 線形モデルによる回帰</a></li>
<li class="chapter" data-level="2.5.2" data-path="2-5-アルゴリズム2-線形モデル.html"><a href="2-5-アルゴリズム2-線形モデル.html#線形回帰通常最小二乗法"><i class="fa fa-check"></i><b>2.5.2</b> 線形回帰(通常最小二乗法)</a></li>
<li class="chapter" data-level="2.5.3" data-path="2-5-アルゴリズム2-線形モデル.html"><a href="2-5-アルゴリズム2-線形モデル.html#リッジ回帰"><i class="fa fa-check"></i><b>2.5.3</b> リッジ回帰</a></li>
<li class="chapter" data-level="2.5.4" data-path="2-5-アルゴリズム2-線形モデル.html"><a href="2-5-アルゴリズム2-線形モデル.html#lasso"><i class="fa fa-check"></i><b>2.5.4</b> Lasso</a></li>
<li class="chapter" data-level="2.5.5" data-path="2-5-アルゴリズム2-線形モデル.html"><a href="2-5-アルゴリズム2-線形モデル.html#クラス分類のための線形モデル"><i class="fa fa-check"></i><b>2.5.5</b> クラス分類のための線形モデル</a></li>
<li class="chapter" data-level="2.5.6" data-path="2-5-アルゴリズム2-線形モデル.html"><a href="2-5-アルゴリズム2-線形モデル.html#線形モデルによる多クラス分類"><i class="fa fa-check"></i><b>2.5.6</b> 線形モデルによる多クラス分類</a></li>
<li class="chapter" data-level="2.5.7" data-path="2-5-アルゴリズム2-線形モデル.html"><a href="2-5-アルゴリズム2-線形モデル.html#利点欠点パラメータ"><i class="fa fa-check"></i><b>2.5.7</b> 利点、欠点、パラメータ</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2-6-ナイーブベイズクラス分類器.html"><a href="2-6-ナイーブベイズクラス分類器.html"><i class="fa fa-check"></i><b>2.6</b> ナイーブベイズクラス分類器</a><ul>
<li class="chapter" data-level="2.6.1" data-path="2-6-ナイーブベイズクラス分類器.html"><a href="2-6-ナイーブベイズクラス分類器.html#利点欠点パラメータ-1"><i class="fa fa-check"></i><b>2.6.1</b> 利点、欠点、パラメータ</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="2-7-決定木.html"><a href="2-7-決定木.html"><i class="fa fa-check"></i><b>2.7</b> 決定木</a><ul>
<li class="chapter" data-level="2.7.1" data-path="2-7-決定木.html"><a href="2-7-決定木.html#決定木の構築"><i class="fa fa-check"></i><b>2.7.1</b> 決定木の構築</a></li>
<li class="chapter" data-level="2.7.2" data-path="2-7-決定木.html"><a href="2-7-決定木.html#決定木の複雑さの制御"><i class="fa fa-check"></i><b>2.7.2</b> 決定木の複雑さの制御</a></li>
<li class="chapter" data-level="2.7.3" data-path="2-7-決定木.html"><a href="2-7-決定木.html#決定木の解析"><i class="fa fa-check"></i><b>2.7.3</b> 決定木の解析</a></li>
<li class="chapter" data-level="2.7.4" data-path="2-7-決定木.html"><a href="2-7-決定木.html#決定木の特徴量の重要性"><i class="fa fa-check"></i><b>2.7.4</b> 決定木の特徴量の重要性</a></li>
<li class="chapter" data-level="2.7.5" data-path="2-7-決定木.html"><a href="2-7-決定木.html#長所短所パラメータ"><i class="fa fa-check"></i><b>2.7.5</b> 長所、短所、パラメータ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-教師あり学習-2.html"><a href="3-教師あり学習-2.html"><i class="fa fa-check"></i><b>3</b> 教師あり学習 (2)</a><ul>
<li class="chapter" data-level="3.1" data-path="3-1-決定木のアンサンブル法.html"><a href="3-1-決定木のアンサンブル法.html"><i class="fa fa-check"></i><b>3.1</b> 決定木のアンサンブル法</a><ul>
<li class="chapter" data-level="3.1.1" data-path="3-1-決定木のアンサンブル法.html"><a href="3-1-決定木のアンサンブル法.html#ランダムフォレスト"><i class="fa fa-check"></i><b>3.1.1</b> ランダムフォレスト</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown">
Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Pythonで始める機械学習の学習</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="最初のアプリケーション-アイリスのクラス分類" class="section level2">
<h2><span class="header-section-number">1.6</span> 最初のアプリケーション: アイリスのクラス分類</h2>
<ul>
<li><strong>みんな大好きiris</strong>。</li>
<li>以下の記事が詳しい。
<ul>
<li><a href="http://d.hatena.ne.jp/tsutatsutatsuta/20121206/1354737461">irisの正体 (R Advent Calendar 2012 6日目) - どんな鳥も</a></li>
</ul></li>
</ul>
<div id="データを読む" class="section level3">
<h3><span class="header-section-number">1.6.1</span> データを読む</h3>
<ul>
<li><code>scikit-learn</code>の<code>datasets</code>モジュール
<ul>
<li>いろんなサンプルデータセットが入ってる。</li>
<li><code>sklearn.datasets.load_iris()</code>で<strong>iris</strong>が返ってくるので適当に受けよう。</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris
iris_dataset <span class="op">=</span> load_iris()</code></pre></div>
<p><code>load_iris()</code>は<strong>Bunch</strong>クラスのオブジェクトを返す。これはディクショナリみたいに扱える。値には<code>iris_dataset['data']</code>以外に<code>iris_dataset.data</code>みたいにアクセスしてもいい。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.keys())
 <span class="co">## dict_keys([&#39;target&#39;, &#39;feature_names&#39;, &#39;data&#39;, &#39;DESCR&#39;, &#39;target_names&#39;])</span></code></pre></div>
<p>キー<strong>DESCR</strong>の中にデータセットの説明が入っている。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.DESCR)
 <span class="co">## Iris Plants Database</span>
 <span class="co">## ====================</span>
 <span class="co">## </span>
 <span class="co">## Notes</span>
 <span class="co">## -----</span>
 <span class="co">## Data Set Characteristics:</span>
 <span class="co">##     :Number of Instances: 150 (50 in each of three classes)</span>
 <span class="co">##     :Number of Attributes: 4 numeric, predictive attributes and the class</span>
 <span class="co">##     :Attribute Information:</span>
 <span class="co">##         - sepal length in cm</span>
 <span class="co">##         - sepal width in cm</span>
 <span class="co">##         - petal length in cm</span>
 <span class="co">##         - petal width in cm</span>
 <span class="co">##         - class:</span>
 <span class="co">##                 - Iris-Setosa</span>
 <span class="co">##                 - Iris-Versicolour</span>
 <span class="co">##                 - Iris-Virginica</span>
 <span class="co">##     :Summary Statistics:</span>
 <span class="co">## </span>
 <span class="co">##     ============== ==== ==== ======= ===== ====================</span>
 <span class="co">##                     Min  Max   Mean    SD   Class Correlation</span>
 <span class="co">##     ============== ==== ==== ======= ===== ====================</span>
 <span class="co">##     sepal length:   4.3  7.9   5.84   0.83    0.7826</span>
 <span class="co">##     sepal width:    2.0  4.4   3.05   0.43   -0.4194</span>
 <span class="co">##     petal length:   1.0  6.9   3.76   1.76    0.9490  (high!)</span>
 <span class="co">##     petal width:    0.1  2.5   1.20  0.76     0.9565  (high!)</span>
 <span class="co">##     ============== ==== ==== ======= ===== ====================</span>
 <span class="co">## </span>
 <span class="co">##     :Missing Attribute Values: None</span>
 <span class="co">##     :Class Distribution: 33.3% for each of 3 classes.</span>
 <span class="co">##     :Creator: R.A. Fisher</span>
 <span class="co">##     :Donor: Michael Marshall (MARSHALL%PLU@io.arc.nasa.gov)</span>
 <span class="co">##     :Date: July, 1988</span>
 <span class="co">## </span>
 <span class="co">## This is a copy of UCI ML iris datasets.</span>
 <span class="co">## http://archive.ics.uci.edu/ml/datasets/Iris</span>
 <span class="co">## </span>
 <span class="co">## The famous Iris database, first used by Sir R.A Fisher</span>
 <span class="co">## </span>
 <span class="co">## This is perhaps the best known database to be found in the</span>
 <span class="co">## pattern recognition literature.  Fisher&#39;s paper is a classic in the field and</span>
 <span class="co">## is referenced frequently to this day.  (See Duda &amp; Hart, for example.)  The</span>
 <span class="co">## data set contains 3 classes of 50 instances each, where each class refers to a</span>
 <span class="co">## type of iris plant.  One class is linearly separable from the other 2; the</span>
 <span class="co">## latter are NOT linearly separable from each other.</span>
 <span class="co">## </span>
 <span class="co">## References</span>
 <span class="co">## ----------</span>
 <span class="co">##    - Fisher,R.A. &quot;The use of multiple measurements in taxonomic problems&quot;</span>
 <span class="co">##      Annual Eugenics, 7, Part II, 179-188 (1936); also in &quot;Contributions to</span>
 <span class="co">##      Mathematical Statistics&quot; (John Wiley, NY, 1950).</span>
 <span class="co">##    - Duda,R.O., &amp; Hart,P.E. (1973) Pattern Classification and Scene Analysis.</span>
 <span class="co">##      (Q327.D83) John Wiley &amp; Sons.  ISBN 0-471-22361-1.  See page 218.</span>
 <span class="co">##    - Dasarathy, B.V. (1980) &quot;Nosing Around the Neighborhood: A New System</span>
 <span class="co">##      Structure and Classification Rule for Recognition in Partially Exposed</span>
 <span class="co">##      Environments&quot;.  IEEE Transactions on Pattern Analysis and Machine</span>
 <span class="co">##      Intelligence, Vol. PAMI-2, No. 1, 67-71.</span>
 <span class="co">##    - Gates, G.W. (1972) &quot;The Reduced Nearest Neighbor Rule&quot;.  IEEE Transactions</span>
 <span class="co">##      on Information Theory, May 1972, 431-433.</span>
 <span class="co">##    - See also: 1988 MLC Proceedings, 54-64.  Cheeseman et al&quot;s AUTOCLASS II</span>
 <span class="co">##      conceptual clustering system finds 3 classes in the data.</span>
 <span class="co">##    - Many, many more ...</span></code></pre></div>
<p><strong>target</strong>は符号化されていて、対応する名前は<strong>target_names</strong>に入っている。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.target)
 <span class="co">## [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
 <span class="co">##  0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
 <span class="co">##  1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2</span>
 <span class="co">##  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span>
 <span class="co">##  2 2]</span>
<span class="bu">print</span>(iris_dataset.target_names)
 <span class="co">## [&#39;setosa&#39; &#39;versicolor&#39; &#39;virginica&#39;]</span></code></pre></div>
<p>要するに<strong>target</strong>で<strong>target_names</strong>を参照すると実際の目的変数の構造が見える。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.target_names[iris_dataset.target])
 <span class="co">## [&#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39;</span>
 <span class="co">##  &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39;</span>
 <span class="co">##  &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39;</span>
 <span class="co">##  &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39;</span>
 <span class="co">##  &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39;</span>
 <span class="co">##  &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39;</span>
 <span class="co">##  &#39;setosa&#39; &#39;setosa&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
 <span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
 <span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
 <span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
 <span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
 <span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
 <span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
 <span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
 <span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
 <span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
 <span class="co">##  &#39;versicolor&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
 <span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
 <span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
 <span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
 <span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
 <span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
 <span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
 <span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
 <span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;]</span></code></pre></div>
<p>特徴量は<strong>データ件数</strong>×<strong>特徴量数</strong>のNumPy配列として<strong>data</strong>に入っている。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.data)
 <span class="co">## [[5.1 3.5 1.4 0.2]</span>
 <span class="co">##  [4.9 3.  1.4 0.2]</span>
 <span class="co">##  [4.7 3.2 1.3 0.2]</span>
 <span class="co">##  [4.6 3.1 1.5 0.2]</span>
 <span class="co">##  [5.  3.6 1.4 0.2]</span>
 <span class="co">##  [5.4 3.9 1.7 0.4]</span>
 <span class="co">##  [4.6 3.4 1.4 0.3]</span>
 <span class="co">##  [5.  3.4 1.5 0.2]</span>
 <span class="co">##  [4.4 2.9 1.4 0.2]</span>
 <span class="co">##  [4.9 3.1 1.5 0.1]</span>
 <span class="co">##  [5.4 3.7 1.5 0.2]</span>
 <span class="co">##  [4.8 3.4 1.6 0.2]</span>
 <span class="co">##  [4.8 3.  1.4 0.1]</span>
 <span class="co">##  [4.3 3.  1.1 0.1]</span>
 <span class="co">##  [5.8 4.  1.2 0.2]</span>
 <span class="co">##  [5.7 4.4 1.5 0.4]</span>
 <span class="co">##  [5.4 3.9 1.3 0.4]</span>
 <span class="co">##  [5.1 3.5 1.4 0.3]</span>
 <span class="co">##  [5.7 3.8 1.7 0.3]</span>
 <span class="co">##  [5.1 3.8 1.5 0.3]</span>
 <span class="co">##  [5.4 3.4 1.7 0.2]</span>
 <span class="co">##  [5.1 3.7 1.5 0.4]</span>
 <span class="co">##  [4.6 3.6 1.  0.2]</span>
 <span class="co">##  [5.1 3.3 1.7 0.5]</span>
 <span class="co">##  [4.8 3.4 1.9 0.2]</span>
 <span class="co">##  [5.  3.  1.6 0.2]</span>
 <span class="co">##  [5.  3.4 1.6 0.4]</span>
 <span class="co">##  [5.2 3.5 1.5 0.2]</span>
 <span class="co">##  [5.2 3.4 1.4 0.2]</span>
 <span class="co">##  [4.7 3.2 1.6 0.2]</span>
 <span class="co">##  [4.8 3.1 1.6 0.2]</span>
 <span class="co">##  [5.4 3.4 1.5 0.4]</span>
 <span class="co">##  [5.2 4.1 1.5 0.1]</span>
 <span class="co">##  [5.5 4.2 1.4 0.2]</span>
 <span class="co">##  [4.9 3.1 1.5 0.1]</span>
 <span class="co">##  [5.  3.2 1.2 0.2]</span>
 <span class="co">##  [5.5 3.5 1.3 0.2]</span>
 <span class="co">##  [4.9 3.1 1.5 0.1]</span>
 <span class="co">##  [4.4 3.  1.3 0.2]</span>
 <span class="co">##  [5.1 3.4 1.5 0.2]</span>
 <span class="co">##  [5.  3.5 1.3 0.3]</span>
 <span class="co">##  [4.5 2.3 1.3 0.3]</span>
 <span class="co">##  [4.4 3.2 1.3 0.2]</span>
 <span class="co">##  [5.  3.5 1.6 0.6]</span>
 <span class="co">##  [5.1 3.8 1.9 0.4]</span>
 <span class="co">##  [4.8 3.  1.4 0.3]</span>
 <span class="co">##  [5.1 3.8 1.6 0.2]</span>
 <span class="co">##  [4.6 3.2 1.4 0.2]</span>
 <span class="co">##  [5.3 3.7 1.5 0.2]</span>
 <span class="co">##  [5.  3.3 1.4 0.2]</span>
 <span class="co">##  [7.  3.2 4.7 1.4]</span>
 <span class="co">##  [6.4 3.2 4.5 1.5]</span>
 <span class="co">##  [6.9 3.1 4.9 1.5]</span>
 <span class="co">##  [5.5 2.3 4.  1.3]</span>
 <span class="co">##  [6.5 2.8 4.6 1.5]</span>
 <span class="co">##  [5.7 2.8 4.5 1.3]</span>
 <span class="co">##  [6.3 3.3 4.7 1.6]</span>
 <span class="co">##  [4.9 2.4 3.3 1. ]</span>
 <span class="co">##  [6.6 2.9 4.6 1.3]</span>
 <span class="co">##  [5.2 2.7 3.9 1.4]</span>
 <span class="co">##  [5.  2.  3.5 1. ]</span>
 <span class="co">##  [5.9 3.  4.2 1.5]</span>
 <span class="co">##  [6.  2.2 4.  1. ]</span>
 <span class="co">##  [6.1 2.9 4.7 1.4]</span>
 <span class="co">##  [5.6 2.9 3.6 1.3]</span>
 <span class="co">##  [6.7 3.1 4.4 1.4]</span>
 <span class="co">##  [5.6 3.  4.5 1.5]</span>
 <span class="co">##  [5.8 2.7 4.1 1. ]</span>
 <span class="co">##  [6.2 2.2 4.5 1.5]</span>
 <span class="co">##  [5.6 2.5 3.9 1.1]</span>
 <span class="co">##  [5.9 3.2 4.8 1.8]</span>
 <span class="co">##  [6.1 2.8 4.  1.3]</span>
 <span class="co">##  [6.3 2.5 4.9 1.5]</span>
 <span class="co">##  [6.1 2.8 4.7 1.2]</span>
 <span class="co">##  [6.4 2.9 4.3 1.3]</span>
 <span class="co">##  [6.6 3.  4.4 1.4]</span>
 <span class="co">##  [6.8 2.8 4.8 1.4]</span>
 <span class="co">##  [6.7 3.  5.  1.7]</span>
 <span class="co">##  [6.  2.9 4.5 1.5]</span>
 <span class="co">##  [5.7 2.6 3.5 1. ]</span>
 <span class="co">##  [5.5 2.4 3.8 1.1]</span>
 <span class="co">##  [5.5 2.4 3.7 1. ]</span>
 <span class="co">##  [5.8 2.7 3.9 1.2]</span>
 <span class="co">##  [6.  2.7 5.1 1.6]</span>
 <span class="co">##  [5.4 3.  4.5 1.5]</span>
 <span class="co">##  [6.  3.4 4.5 1.6]</span>
 <span class="co">##  [6.7 3.1 4.7 1.5]</span>
 <span class="co">##  [6.3 2.3 4.4 1.3]</span>
 <span class="co">##  [5.6 3.  4.1 1.3]</span>
 <span class="co">##  [5.5 2.5 4.  1.3]</span>
 <span class="co">##  [5.5 2.6 4.4 1.2]</span>
 <span class="co">##  [6.1 3.  4.6 1.4]</span>
 <span class="co">##  [5.8 2.6 4.  1.2]</span>
 <span class="co">##  [5.  2.3 3.3 1. ]</span>
 <span class="co">##  [5.6 2.7 4.2 1.3]</span>
 <span class="co">##  [5.7 3.  4.2 1.2]</span>
 <span class="co">##  [5.7 2.9 4.2 1.3]</span>
 <span class="co">##  [6.2 2.9 4.3 1.3]</span>
 <span class="co">##  [5.1 2.5 3.  1.1]</span>
 <span class="co">##  [5.7 2.8 4.1 1.3]</span>
 <span class="co">##  [6.3 3.3 6.  2.5]</span>
 <span class="co">##  [5.8 2.7 5.1 1.9]</span>
 <span class="co">##  [7.1 3.  5.9 2.1]</span>
 <span class="co">##  [6.3 2.9 5.6 1.8]</span>
 <span class="co">##  [6.5 3.  5.8 2.2]</span>
 <span class="co">##  [7.6 3.  6.6 2.1]</span>
 <span class="co">##  [4.9 2.5 4.5 1.7]</span>
 <span class="co">##  [7.3 2.9 6.3 1.8]</span>
 <span class="co">##  [6.7 2.5 5.8 1.8]</span>
 <span class="co">##  [7.2 3.6 6.1 2.5]</span>
 <span class="co">##  [6.5 3.2 5.1 2. ]</span>
 <span class="co">##  [6.4 2.7 5.3 1.9]</span>
 <span class="co">##  [6.8 3.  5.5 2.1]</span>
 <span class="co">##  [5.7 2.5 5.  2. ]</span>
 <span class="co">##  [5.8 2.8 5.1 2.4]</span>
 <span class="co">##  [6.4 3.2 5.3 2.3]</span>
 <span class="co">##  [6.5 3.  5.5 1.8]</span>
 <span class="co">##  [7.7 3.8 6.7 2.2]</span>
 <span class="co">##  [7.7 2.6 6.9 2.3]</span>
 <span class="co">##  [6.  2.2 5.  1.5]</span>
 <span class="co">##  [6.9 3.2 5.7 2.3]</span>
 <span class="co">##  [5.6 2.8 4.9 2. ]</span>
 <span class="co">##  [7.7 2.8 6.7 2. ]</span>
 <span class="co">##  [6.3 2.7 4.9 1.8]</span>
 <span class="co">##  [6.7 3.3 5.7 2.1]</span>
 <span class="co">##  [7.2 3.2 6.  1.8]</span>
 <span class="co">##  [6.2 2.8 4.8 1.8]</span>
 <span class="co">##  [6.1 3.  4.9 1.8]</span>
 <span class="co">##  [6.4 2.8 5.6 2.1]</span>
 <span class="co">##  [7.2 3.  5.8 1.6]</span>
 <span class="co">##  [7.4 2.8 6.1 1.9]</span>
 <span class="co">##  [7.9 3.8 6.4 2. ]</span>
 <span class="co">##  [6.4 2.8 5.6 2.2]</span>
 <span class="co">##  [6.3 2.8 5.1 1.5]</span>
 <span class="co">##  [6.1 2.6 5.6 1.4]</span>
 <span class="co">##  [7.7 3.  6.1 2.3]</span>
 <span class="co">##  [6.3 3.4 5.6 2.4]</span>
 <span class="co">##  [6.4 3.1 5.5 1.8]</span>
 <span class="co">##  [6.  3.  4.8 1.8]</span>
 <span class="co">##  [6.9 3.1 5.4 2.1]</span>
 <span class="co">##  [6.7 3.1 5.6 2.4]</span>
 <span class="co">##  [6.9 3.1 5.1 2.3]</span>
 <span class="co">##  [5.8 2.7 5.1 1.9]</span>
 <span class="co">##  [6.8 3.2 5.9 2.3]</span>
 <span class="co">##  [6.7 3.3 5.7 2.5]</span>
 <span class="co">##  [6.7 3.  5.2 2.3]</span>
 <span class="co">##  [6.3 2.5 5.  1.9]</span>
 <span class="co">##  [6.5 3.  5.2 2. ]</span>
 <span class="co">##  [6.2 3.4 5.4 2.3]</span>
 <span class="co">##  [5.9 3.  5.1 1.8]]</span></code></pre></div>
<p><strong>data</strong>の各列は1種類の特徴量に対応するが、具体的になんという特徴量なのかは<strong>feature_names</strong>に入っている。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.feature_names)
 <span class="co">## [&#39;sepal length (cm)&#39;, &#39;sepal width (cm)&#39;, &#39;petal length (cm)&#39;, &#39;petal width (cm)&#39;]</span></code></pre></div>
<p>NumPy配列の扱い方を簡単に。配列の形状(次元)はshapeで取得できる。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.data.shape)
 <span class="co">## (150, 4)</span></code></pre></div>
<p>普通の配列みたいにスライスできる。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.data[:<span class="dv">5</span>])
 <span class="co">## [[5.1 3.5 1.4 0.2]</span>
 <span class="co">##  [4.9 3.  1.4 0.2]</span>
 <span class="co">##  [4.7 3.2 1.3 0.2]</span>
 <span class="co">##  [4.6 3.1 1.5 0.2]</span>
 <span class="co">##  [5.  3.6 1.4 0.2]]</span></code></pre></div>
</div>
<div id="成功度合いの測定-訓練データとテストデータ" class="section level3">
<h3><span class="header-section-number">1.6.2</span> 成功度合いの測定: 訓練データとテストデータ</h3>
<ul>
<li><strong>未知の測定値からアヤメの品種を予測する</strong>みたいなことやりたい。</li>
<li><strong>未知の入力</strong>に対する予測能力 is <strong>汎化能力</strong>。
<ul>
<li>こいつを最大化するのが目的。</li>
</ul></li>
<li>訓練に使ったデータはモデルの評価に使えない。
<ul>
<li>そのデータに対してモデルを最適化しているので、良い性能が出るのは当然。</li>
<li>一部だけ訓練に使って残りをテスト用に取っておけばよいのでは？ → <strong>ホールドアウト法</strong></li>
<li>訓練に使うデータセット: <strong>訓練データ</strong> or <strong>訓練セット</strong>。</li>
<li>テストに使うデータセット: <strong>テストデータ</strong> or <strong>テストセット</strong>。</li>
<li><strong>scikit-learn</strong>でホールドアウト法をやるなら<strong>model_selection.train_test_split</strong>。</li>
</ul></li>
<li><strong>scikit-learn</strong>的な慣習
<ul>
<li>(入力)データは<strong>X</strong>で表す</li>
<li>データラベル(=入力に対応する出力)は<strong>y</strong>で表す</li>
<li>入力は行列で出力はベクトルなので、<span class="math inline">\(f(\textbf{X}) = \textbf{y}\)</span>ということらしい。</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split
X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(
  iris_dataset.data, iris_dataset.target, random_state <span class="op">=</span> <span class="dv">0</span>
)</code></pre></div>
<ul>
<li>引数<strong>random_state</strong>は乱数種を固定する。再現性確保のため。</li>
<li>デフォルトで訓練:テスト=3:1に分解する。</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(X_train.shape)
 <span class="co">## (112, 4)</span>
<span class="bu">print</span>(y_train.shape)
 <span class="co">## (112,)</span>
<span class="bu">print</span>(X_test.shape)
 <span class="co">## (38, 4)</span>
<span class="bu">print</span>(y_test.shape)
 <span class="co">## (38,)</span></code></pre></div>
</div>
<div id="最初にすべきこと-データを良く観察する" class="section level3">
<h3><span class="header-section-number">1.6.3</span> 最初にすべきこと: データを良く観察する</h3>
<ul>
<li>まずは散布図を作れ</li>
<li>多変量ならペアプロット(散布図行列)を作れ
<ul>
<li><strong>pandas</strong>にペアプロット作成関数があるので、<strong>pandas.DataFrame</strong>に変換して作業するとよい。</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">## DataFrameへの変換</span>
<span class="im">import</span> pandas <span class="im">as</span> pd
iris_dataframe <span class="op">=</span> pd.DataFrame(X_train, columns <span class="op">=</span> iris_dataset.feature_names)</code></pre></div>
<ul>
<li>注: テキストで指定しているオプションの大半は外観調整のためのものなので、なくてもいい。</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt
<span class="im">import</span> mglearn
<span class="co">## プロット</span>
<span class="co"># pandas.scatter_matrixはdeprecated</span>
pd.plotting.scatter_matrix( 
  iris_dataframe,    <span class="co"># データの指定</span>
  c <span class="op">=</span> y_train,       <span class="co"># データポイントの色を出力=品種に対応付ける</span>
  figsize <span class="op">=</span> (<span class="dv">15</span>, <span class="dv">15</span>),<span class="co"># 画像出力サイズの指定(なくてもいい)</span>
  marker <span class="op">=</span> <span class="st">&#39;o&#39;</span>,      <span class="co"># ポイントマーカーの指定(なくてもいい)</span>
  hist_kwds <span class="op">=</span> {<span class="st">&#39;bins&#39;</span>: <span class="dv">20</span>}, <span class="co"># ヒストグラムを作る関数に渡す引数の指定(とりあえずなくてもいい)</span>
  s <span class="op">=</span> <span class="dv">60</span>,            <span class="co"># データポイントのサイズ？(なくてもいい)</span>
  alpha <span class="op">=</span> .<span class="dv">8</span>,        <span class="co"># 透過度調整(なくてもいい)</span>
  cmap <span class="op">=</span> mglearn.cm3 <span class="co"># 配色設定(カラーマップ、なくてもいい)</span>
)
<span class="co">## 表示</span>
plt.show()</code></pre></div>
<p><img src="01_intro_files/figure-html/unnamed-chunk-13-1.png" /><!-- --></p>
</div>
<div id="最初のモデル-k-最近傍法" class="section level3">
<h3><span class="header-section-number">1.6.4</span> 最初のモデル: k-最近傍法</h3>
<ul>
<li><strong>距離的に近いやつは仲間でいいんじゃね？</strong>に基づくアルゴリズム。</li>
<li><strong>scikit-learn</strong>のアルゴリズムを使うためには、アルゴリズムに対応するオブジェクトのインスタンスを生成する必要がある。</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier
knn <span class="op">=</span> KNeighborsClassifier(n_neighbors <span class="op">=</span> <span class="dv">1</span>) <span class="co"># インスタンス生成時にパラメータを指定できるものもある</span></code></pre></div>
<p>モデルに訓練セットを適合させるためには、<code>fit</code>メソッドを呼び出して訓練セットを渡すだけで良い。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">knn.fit(X_train, y_train)</code></pre></div>
</div>
<div id="予測を行う" class="section level3">
<h3><span class="header-section-number">1.6.5</span> 予測を行う</h3>
<p>予測は<code>predict</code>メソッドで行う。適当にデータを生成して予測してみよう。予測結果は符号化された値になるが、<code>iris_dataset.target_names</code>を使うと実際のラベル名が分かる。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> numpy <span class="im">as</span> np
X_new <span class="op">=</span> np.array([[<span class="dv">5</span>, <span class="fl">2.9</span>, <span class="dv">1</span>, <span class="fl">0.2</span>]])
<span class="bu">print</span>(knn.predict(X_new))
 <span class="co">## [0]</span>
<span class="bu">print</span>(iris_dataset.target_names[knn.predict(X_new)])
 <span class="co">## [&#39;setosa&#39;]</span></code></pre></div>
<ul>
<li>適当な数字から予測したから<strong>正解なのかどうか分からない！</strong></li>
<li>そのためのテストデータ。</li>
</ul>
</div>
<div id="モデルの評価" class="section level3">
<h3><span class="header-section-number">1.6.6</span> モデルの評価</h3>
<ul>
<li><strong>精度 (accuracy)</strong>: テストデータのラベルを正しく判別できた割合。</li>
<li>テストデータを使って予測を行い、正解と同じラベルがどれだけあるか、をカウントする。</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># 予測</span>
y_pred <span class="op">=</span> knn.predict(X_test)
<span class="co"># 比較</span>
<span class="bu">print</span>(y_pred <span class="op">==</span> y_test)
 <span class="co">## [ True  True  True  True  True  True  True  True  True  True  True  True</span>
 <span class="co">##   True  True  True  True  True  True  True  True  True  True  True  True</span>
 <span class="co">##   True  True  True  True  True  True  True  True  True  True  True  True</span>
 <span class="co">##   True False]</span></code></pre></div>
<p>pythonは数値計算の際Trueは1、Falseは0として扱うので、<code>y_pred == y_test</code>の平均値がそのまま精度になる。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(np.mean(y_pred <span class="op">==</span> y_test))
 <span class="co">## 0.9736842105263158</span></code></pre></div>
<p>予測から精度計算まで一発でやってくれるメソッドとして<code>score</code>もある。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(knn.score(X_test, y_test))
 <span class="co">## 0.9736842105263158</span></code></pre></div>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="1-5-python-2-vs-python-3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2-教師あり学習-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/nozma/ml_with_python_note/edit/master/01_intro.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
