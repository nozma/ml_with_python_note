<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="section-2.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>まえおき</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#e696b9e9879d"><i class="fa fa-check"></i>方針</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#e59fb7e7ad86e792b0e5a283e381a8e3818b"><i class="fa fa-check"></i>執筆環境とか</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="section-1.html"><a href="section-1.html"><i class="fa fa-check"></i><b>1</b> はじめに</a><ul>
<li class="chapter" data-level="1.1" data-path="section-1.html"><a href="section-1.html#section-1.1"><i class="fa fa-check"></i><b>1.1</b> なぜ機械学習なのか</a><ul>
<li class="chapter" data-level="1.1.1" data-path="section-1.html"><a href="section-1.html#section-1.1.1"><i class="fa fa-check"></i><b>1.1.1</b> 機械学習で解決可能な問題</a></li>
<li class="chapter" data-level="1.1.2" data-path="section-1.html"><a href="section-1.html#section-1.1.2"><i class="fa fa-check"></i><b>1.1.2</b> タスクを知り、データを知る</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="section-1.html"><a href="section-1.html#python"><i class="fa fa-check"></i><b>1.2</b> なぜPythonなのか？</a></li>
<li class="chapter" data-level="1.3" data-path="section-1.html"><a href="section-1.html#scikit-learn"><i class="fa fa-check"></i><b>1.3</b> scikit-learn</a><ul>
<li class="chapter" data-level="1.3.1" data-path="section-1.html"><a href="section-1.html#section-1.3.1"><i class="fa fa-check"></i><b>1.3.1</b> インストール</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="section-1.html"><a href="section-1.html#section-1.4"><i class="fa fa-check"></i><b>1.4</b> 必要なライブラリとツール</a></li>
<li class="chapter" data-level="1.5" data-path="section-1.html"><a href="section-1.html#python-2-vs.python-3"><i class="fa fa-check"></i><b>1.5</b> Python 2 vs. Python 3</a></li>
<li class="chapter" data-level="1.6" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>1.6</b> 最初のアプリケーション: アイリスのクラス分類</a><ul>
<li class="chapter" data-level="1.6.1" data-path="section-1.html"><a href="section-1.html#section-1.6.1"><i class="fa fa-check"></i><b>1.6.1</b> データを読む</a></li>
<li class="chapter" data-level="1.6.2" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>1.6.2</b> 成功度合いの測定: 訓練データとテストデータ</a></li>
<li class="chapter" data-level="1.6.3" data-path="section-1.html"><a href="section-1.html#-"><i class="fa fa-check"></i><b>1.6.3</b> 最初にすべきこと: データを良く観察する</a></li>
<li class="chapter" data-level="1.6.4" data-path="section-1.html"><a href="section-1.html#-k-"><i class="fa fa-check"></i><b>1.6.4</b> 最初のモデル: k-最近傍法</a></li>
<li class="chapter" data-level="1.6.5" data-path="section-1.html"><a href="section-1.html#section-1.6.5"><i class="fa fa-check"></i><b>1.6.5</b> 予測を行う</a></li>
<li class="chapter" data-level="1.6.6" data-path="section-1.html"><a href="section-1.html#section-1.6.6"><i class="fa fa-check"></i><b>1.6.6</b> モデルの評価</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="section-2.html"><a href="section-2.html"><i class="fa fa-check"></i><b>2</b> 教師あり学習</a><ul>
<li class="chapter" data-level="2.1" data-path="section-2.html"><a href="section-2.html#section-2.1"><i class="fa fa-check"></i><b>2.1</b> クラス分類と回帰</a></li>
<li class="chapter" data-level="2.2" data-path="section-2.html"><a href="section-2.html#section-2.2"><i class="fa fa-check"></i><b>2.2</b> 汎化、過剰適合、適合不足</a><ul>
<li class="chapter" data-level="2.2.1" data-path="section-2.html"><a href="section-2.html#section-2.2.1"><i class="fa fa-check"></i><b>2.2.1</b> モデルの複雑さとデータセットの大きさ</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="section-2.html"><a href="section-2.html#section-2.3"><i class="fa fa-check"></i><b>2.3</b> 教師あり機械学習アルゴリズム</a><ul>
<li class="chapter" data-level="2.3.1" data-path="section-2.html"><a href="section-2.html#section-2.3.1"><i class="fa fa-check"></i><b>2.3.1</b> サンプルデータセット</a></li>
<li class="chapter" data-level="2.3.2" data-path="section-2.html"><a href="section-2.html#k-"><i class="fa fa-check"></i><b>2.3.2</b> <span class="math inline">\(k\)</span>-最近傍法</a></li>
<li class="chapter" data-level="2.3.3" data-path="section-2.html"><a href="section-2.html#section-2.3.3"><i class="fa fa-check"></i><b>2.3.3</b> 線形モデル</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-1" class="section level1">
<h1><span class="header-section-number">1</span> はじめに</h1>
<div id="section-1.1" class="section level2">
<h2><span class="header-section-number">1.1</span> なぜ機械学習なのか</h2>
<ul>
<li>if〜then〜のエキスパートシステムには限界がある。
<ul>
<li>ロジックがドメイン固有のものになり、タスクが変化したら作り直さないといけない。</li>
<li>人間のエキスパートの思考に対する深い理解が必要。</li>
<li>顔認識とかはちょっと無理。</li>
</ul></li>
</ul>
<div id="section-1.1.1" class="section level3">
<h3><span class="header-section-number">1.1.1</span> 機械学習で解決可能な問題</h3>
<p>世の中には教師のある学習と教師のない学習がある。</p>
<ul>
<li><strong>教師あり学習</strong>
<ul>
<li>入力と出力のペアを与えてアルゴリズムを学習させる。</li>
<li>未知の入力に対する出力を予測する。</li>
<li>データセットを集めることが大変な場合もある。</li>
</ul></li>
<li><strong>教師なし学習</strong>
<ul>
<li>出力のないデータセットでアルゴリズムを学習させる。</li>
<li>トピック解析やクラスタリング、異常検知など。</li>
</ul></li>
</ul>
<p>サンプルと特徴量。</p>
<ul>
<li><strong>サンプル</strong>
<ul>
<li>個々のエンティティまたは量。</li>
</ul></li>
<li><strong>特徴量</strong>
<ul>
<li>エンティティの持つ特性を表現する列。</li>
</ul></li>
</ul>
<p><em>情報量のないデータからは学習できない</em>ことを覚えておくこと。</p>
</div>
<div id="section-1.1.2" class="section level3">
<h3><span class="header-section-number">1.1.2</span> タスクを知り、データを知る</h3>
<ul>
<li>よくデータを理解すること
<ul>
<li>そのデータでそもそも問題を解決できるのか？</li>
<li>どんな機械学習の問題に置き換えるべきか？</li>
<li>データの数は十分か？</li>
</ul></li>
</ul>
<p>アルゴリズムは問題の一部にすぎない。全体を心に留めておくこと。</p>
</div>
</div>
<div id="python" class="section level2">
<h2><span class="header-section-number">1.2</span> なぜPythonなのか？</h2>
<ul>
<li>つよい</li>
<li>汎用言語の強さとドメイン特価スクリプト言語の強さがある。</li>
<li>Jupyter Notebookが使える</li>
<li>データ解析はインタラクティブな過程。</li>
</ul>
</div>
<div id="scikit-learn" class="section level2">
<h2><span class="header-section-number">1.3</span> scikit-learn</h2>
<ul>
<li>Pythonで機械学習といったらこれ</li>
<li>オープンソース</li>
<li>ユーザーガイドも読んでおこうな
<ul>
<li><a href="http://scikit-learn.org/stable/user_guide.html" class="uri">http://scikit-learn.org/stable/user_guide.html</a></li>
</ul></li>
</ul>
<div id="section-1.3.1" class="section level3">
<h3><span class="header-section-number">1.3.1</span> インストール</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="ex">pip</span> install numpy scipy matplotlib ipython scikit-learn pandas pillow</code></pre></div>
<p>最近はanaconda使わずにvenvやDocker使うのが流れっぽい気がしますがPython界隈の環境構築はすぐに主流が変わるので正直よく分かりません。</p>
</div>
</div>
<div id="section-1.4" class="section level2">
<h2><span class="header-section-number">1.4</span> 必要なライブラリとツール</h2>
<ul>
<li>Jupyter Notebook
<ul>
<li>ブラウザ上でMarkdownとコード混ぜて書けるやつ。</li>
</ul></li>
<li>NumPy
<ul>
<li>配列計算ﾒｯﾁｬﾊﾔｲやつ</li>
</ul></li>
<li>SciPy
<ul>
<li>科学技術計算できるやつ</li>
</ul></li>
<li>matplotlib
<ul>
<li>プロットするやつ</li>
</ul></li>
<li>pandas
<ul>
<li>Rのデータフレーム的な感じでデータ扱えるやつ</li>
</ul></li>
<li>mglearn
<ul>
<li>「こちらに予め調理したものがあります」的に教科書の例試せるやつ</li>
</ul></li>
</ul>
</div>
<div id="python-2-vs.python-3" class="section level2">
<h2><span class="header-section-number">1.5</span> Python 2 vs. Python 3</h2>
<p>3でやれ。</p>
</div>
<div id="-" class="section level2">
<h2><span class="header-section-number">1.6</span> 最初のアプリケーション: アイリスのクラス分類</h2>
<ul>
<li><strong>みんな大好きiris</strong>。</li>
<li>以下の記事が詳しい。
<ul>
<li><a href="http://d.hatena.ne.jp/tsutatsutatsuta/20121206/1354737461">irisの正体 (R Advent Calendar 2012 6日目) - どんな鳥も</a></li>
</ul></li>
</ul>
<div id="section-1.6.1" class="section level3">
<h3><span class="header-section-number">1.6.1</span> データを読む</h3>
<ul>
<li><code>scikit-learn</code>の<code>datasets</code>モジュール
<ul>
<li>いろんなサンプルデータセットが入ってる。</li>
<li><code>sklearn.datasets.load_iris()</code>で<strong>iris</strong>が返ってくるので適当に受けよう。</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris
iris_dataset <span class="op">=</span> load_iris()</code></pre></div>
<p><code>load_iris()</code>は<strong>Bunch</strong>クラスのオブジェクトを返す。これはディクショナリみたいに扱える。値には<code>iris_dataset['data']</code>以外に<code>iris_dataset.data</code>みたいにアクセスしてもいい。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.keys())
<span class="co">## dict_keys([&#39;data&#39;, &#39;target&#39;, &#39;target_names&#39;, &#39;DESCR&#39;, &#39;feature_names&#39;])</span></code></pre></div>
<p>キー<strong>DESCR</strong>の中にデータセットの説明が入っている。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.DESCR)
<span class="co">## Iris Plants Database</span>
<span class="co">## ====================</span>
<span class="co">## </span>
<span class="co">## Notes</span>
<span class="co">## -----</span>
<span class="co">## Data Set Characteristics:</span>
<span class="co">##     :Number of Instances: 150 (50 in each of three classes)</span>
<span class="co">##     :Number of Attributes: 4 numeric, predictive attributes and the class</span>
<span class="co">##     :Attribute Information:</span>
<span class="co">##         - sepal length in cm</span>
<span class="co">##         - sepal width in cm</span>
<span class="co">##         - petal length in cm</span>
<span class="co">##         - petal width in cm</span>
<span class="co">##         - class:</span>
<span class="co">##                 - Iris-Setosa</span>
<span class="co">##                 - Iris-Versicolour</span>
<span class="co">##                 - Iris-Virginica</span>
<span class="co">##     :Summary Statistics:</span>
<span class="co">## </span>
<span class="co">##     ============== ==== ==== ======= ===== ====================</span>
<span class="co">##                     Min  Max   Mean    SD   Class Correlation</span>
<span class="co">##     ============== ==== ==== ======= ===== ====================</span>
<span class="co">##     sepal length:   4.3  7.9   5.84   0.83    0.7826</span>
<span class="co">##     sepal width:    2.0  4.4   3.05   0.43   -0.4194</span>
<span class="co">##     petal length:   1.0  6.9   3.76   1.76    0.9490  (high!)</span>
<span class="co">##     petal width:    0.1  2.5   1.20  0.76     0.9565  (high!)</span>
<span class="co">##     ============== ==== ==== ======= ===== ====================</span>
<span class="co">## </span>
<span class="co">##     :Missing Attribute Values: None</span>
<span class="co">##     :Class Distribution: 33.3% for each of 3 classes.</span>
<span class="co">##     :Creator: R.A. Fisher</span>
<span class="co">##     :Donor: Michael Marshall (MARSHALL%PLU@io.arc.nasa.gov)</span>
<span class="co">##     :Date: July, 1988</span>
<span class="co">## </span>
<span class="co">## This is a copy of UCI ML iris datasets.</span>
<span class="co">## http://archive.ics.uci.edu/ml/datasets/Iris</span>
<span class="co">## </span>
<span class="co">## The famous Iris database, first used by Sir R.A Fisher</span>
<span class="co">## </span>
<span class="co">## This is perhaps the best known database to be found in the</span>
<span class="co">## pattern recognition literature.  Fisher&#39;s paper is a classic in the field and</span>
<span class="co">## is referenced frequently to this day.  (See Duda &amp; Hart, for example.)  The</span>
<span class="co">## data set contains 3 classes of 50 instances each, where each class refers to a</span>
<span class="co">## type of iris plant.  One class is linearly separable from the other 2; the</span>
<span class="co">## latter are NOT linearly separable from each other.</span>
<span class="co">## </span>
<span class="co">## References</span>
<span class="co">## ----------</span>
<span class="co">##    - Fisher,R.A. &quot;The use of multiple measurements in taxonomic problems&quot;</span>
<span class="co">##      Annual Eugenics, 7, Part II, 179-188 (1936); also in &quot;Contributions to</span>
<span class="co">##      Mathematical Statistics&quot; (John Wiley, NY, 1950).</span>
<span class="co">##    - Duda,R.O., &amp; Hart,P.E. (1973) Pattern Classification and Scene Analysis.</span>
<span class="co">##      (Q327.D83) John Wiley &amp; Sons.  ISBN 0-471-22361-1.  See page 218.</span>
<span class="co">##    - Dasarathy, B.V. (1980) &quot;Nosing Around the Neighborhood: A New System</span>
<span class="co">##      Structure and Classification Rule for Recognition in Partially Exposed</span>
<span class="co">##      Environments&quot;.  IEEE Transactions on Pattern Analysis and Machine</span>
<span class="co">##      Intelligence, Vol. PAMI-2, No. 1, 67-71.</span>
<span class="co">##    - Gates, G.W. (1972) &quot;The Reduced Nearest Neighbor Rule&quot;.  IEEE Transactions</span>
<span class="co">##      on Information Theory, May 1972, 431-433.</span>
<span class="co">##    - See also: 1988 MLC Proceedings, 54-64.  Cheeseman et al&quot;s AUTOCLASS II</span>
<span class="co">##      conceptual clustering system finds 3 classes in the data.</span>
<span class="co">##    - Many, many more ...</span></code></pre></div>
<p><strong>target</strong>は符号化されていて、対応する名前は<strong>target_names</strong>に入っている。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.target)
<span class="co">## [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">##  0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##  1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2</span>
<span class="co">##  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span>
<span class="co">##  2 2]</span>
<span class="bu">print</span>(iris_dataset.target_names)
<span class="co">## [&#39;setosa&#39; &#39;versicolor&#39; &#39;virginica&#39;]</span></code></pre></div>
<p>要するに<strong>target</strong>で<strong>target_names</strong>を参照すると実際の目的変数の構造が見える。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.target_names[iris_dataset.target])
<span class="co">## [&#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39;</span>
<span class="co">##  &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39;</span>
<span class="co">##  &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39;</span>
<span class="co">##  &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39;</span>
<span class="co">##  &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39;</span>
<span class="co">##  &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39; &#39;setosa&#39;</span>
<span class="co">##  &#39;setosa&#39; &#39;setosa&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
<span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
<span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
<span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
<span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
<span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
<span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
<span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
<span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
<span class="co">##  &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39; &#39;versicolor&#39;</span>
<span class="co">##  &#39;versicolor&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
<span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
<span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
<span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
<span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
<span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
<span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
<span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;</span>
<span class="co">##  &#39;virginica&#39; &#39;virginica&#39; &#39;virginica&#39;]</span></code></pre></div>
<p>特徴量は<strong>データ件数</strong>×<strong>特徴量数</strong>のNumPy配列として<strong>data</strong>に入っている。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.data)
<span class="co">## [[5.1 3.5 1.4 0.2]</span>
<span class="co">##  [4.9 3.  1.4 0.2]</span>
<span class="co">##  [4.7 3.2 1.3 0.2]</span>
<span class="co">##  [4.6 3.1 1.5 0.2]</span>
<span class="co">##  [5.  3.6 1.4 0.2]</span>
<span class="co">##  [5.4 3.9 1.7 0.4]</span>
<span class="co">##  [4.6 3.4 1.4 0.3]</span>
<span class="co">##  [5.  3.4 1.5 0.2]</span>
<span class="co">##  [4.4 2.9 1.4 0.2]</span>
<span class="co">##  [4.9 3.1 1.5 0.1]</span>
<span class="co">##  [5.4 3.7 1.5 0.2]</span>
<span class="co">##  [4.8 3.4 1.6 0.2]</span>
<span class="co">##  [4.8 3.  1.4 0.1]</span>
<span class="co">##  [4.3 3.  1.1 0.1]</span>
<span class="co">##  [5.8 4.  1.2 0.2]</span>
<span class="co">##  [5.7 4.4 1.5 0.4]</span>
<span class="co">##  [5.4 3.9 1.3 0.4]</span>
<span class="co">##  [5.1 3.5 1.4 0.3]</span>
<span class="co">##  [5.7 3.8 1.7 0.3]</span>
<span class="co">##  [5.1 3.8 1.5 0.3]</span>
<span class="co">##  [5.4 3.4 1.7 0.2]</span>
<span class="co">##  [5.1 3.7 1.5 0.4]</span>
<span class="co">##  [4.6 3.6 1.  0.2]</span>
<span class="co">##  [5.1 3.3 1.7 0.5]</span>
<span class="co">##  [4.8 3.4 1.9 0.2]</span>
<span class="co">##  [5.  3.  1.6 0.2]</span>
<span class="co">##  [5.  3.4 1.6 0.4]</span>
<span class="co">##  [5.2 3.5 1.5 0.2]</span>
<span class="co">##  [5.2 3.4 1.4 0.2]</span>
<span class="co">##  [4.7 3.2 1.6 0.2]</span>
<span class="co">##  [4.8 3.1 1.6 0.2]</span>
<span class="co">##  [5.4 3.4 1.5 0.4]</span>
<span class="co">##  [5.2 4.1 1.5 0.1]</span>
<span class="co">##  [5.5 4.2 1.4 0.2]</span>
<span class="co">##  [4.9 3.1 1.5 0.1]</span>
<span class="co">##  [5.  3.2 1.2 0.2]</span>
<span class="co">##  [5.5 3.5 1.3 0.2]</span>
<span class="co">##  [4.9 3.1 1.5 0.1]</span>
<span class="co">##  [4.4 3.  1.3 0.2]</span>
<span class="co">##  [5.1 3.4 1.5 0.2]</span>
<span class="co">##  [5.  3.5 1.3 0.3]</span>
<span class="co">##  [4.5 2.3 1.3 0.3]</span>
<span class="co">##  [4.4 3.2 1.3 0.2]</span>
<span class="co">##  [5.  3.5 1.6 0.6]</span>
<span class="co">##  [5.1 3.8 1.9 0.4]</span>
<span class="co">##  [4.8 3.  1.4 0.3]</span>
<span class="co">##  [5.1 3.8 1.6 0.2]</span>
<span class="co">##  [4.6 3.2 1.4 0.2]</span>
<span class="co">##  [5.3 3.7 1.5 0.2]</span>
<span class="co">##  [5.  3.3 1.4 0.2]</span>
<span class="co">##  [7.  3.2 4.7 1.4]</span>
<span class="co">##  [6.4 3.2 4.5 1.5]</span>
<span class="co">##  [6.9 3.1 4.9 1.5]</span>
<span class="co">##  [5.5 2.3 4.  1.3]</span>
<span class="co">##  [6.5 2.8 4.6 1.5]</span>
<span class="co">##  [5.7 2.8 4.5 1.3]</span>
<span class="co">##  [6.3 3.3 4.7 1.6]</span>
<span class="co">##  [4.9 2.4 3.3 1. ]</span>
<span class="co">##  [6.6 2.9 4.6 1.3]</span>
<span class="co">##  [5.2 2.7 3.9 1.4]</span>
<span class="co">##  [5.  2.  3.5 1. ]</span>
<span class="co">##  [5.9 3.  4.2 1.5]</span>
<span class="co">##  [6.  2.2 4.  1. ]</span>
<span class="co">##  [6.1 2.9 4.7 1.4]</span>
<span class="co">##  [5.6 2.9 3.6 1.3]</span>
<span class="co">##  [6.7 3.1 4.4 1.4]</span>
<span class="co">##  [5.6 3.  4.5 1.5]</span>
<span class="co">##  [5.8 2.7 4.1 1. ]</span>
<span class="co">##  [6.2 2.2 4.5 1.5]</span>
<span class="co">##  [5.6 2.5 3.9 1.1]</span>
<span class="co">##  [5.9 3.2 4.8 1.8]</span>
<span class="co">##  [6.1 2.8 4.  1.3]</span>
<span class="co">##  [6.3 2.5 4.9 1.5]</span>
<span class="co">##  [6.1 2.8 4.7 1.2]</span>
<span class="co">##  [6.4 2.9 4.3 1.3]</span>
<span class="co">##  [6.6 3.  4.4 1.4]</span>
<span class="co">##  [6.8 2.8 4.8 1.4]</span>
<span class="co">##  [6.7 3.  5.  1.7]</span>
<span class="co">##  [6.  2.9 4.5 1.5]</span>
<span class="co">##  [5.7 2.6 3.5 1. ]</span>
<span class="co">##  [5.5 2.4 3.8 1.1]</span>
<span class="co">##  [5.5 2.4 3.7 1. ]</span>
<span class="co">##  [5.8 2.7 3.9 1.2]</span>
<span class="co">##  [6.  2.7 5.1 1.6]</span>
<span class="co">##  [5.4 3.  4.5 1.5]</span>
<span class="co">##  [6.  3.4 4.5 1.6]</span>
<span class="co">##  [6.7 3.1 4.7 1.5]</span>
<span class="co">##  [6.3 2.3 4.4 1.3]</span>
<span class="co">##  [5.6 3.  4.1 1.3]</span>
<span class="co">##  [5.5 2.5 4.  1.3]</span>
<span class="co">##  [5.5 2.6 4.4 1.2]</span>
<span class="co">##  [6.1 3.  4.6 1.4]</span>
<span class="co">##  [5.8 2.6 4.  1.2]</span>
<span class="co">##  [5.  2.3 3.3 1. ]</span>
<span class="co">##  [5.6 2.7 4.2 1.3]</span>
<span class="co">##  [5.7 3.  4.2 1.2]</span>
<span class="co">##  [5.7 2.9 4.2 1.3]</span>
<span class="co">##  [6.2 2.9 4.3 1.3]</span>
<span class="co">##  [5.1 2.5 3.  1.1]</span>
<span class="co">##  [5.7 2.8 4.1 1.3]</span>
<span class="co">##  [6.3 3.3 6.  2.5]</span>
<span class="co">##  [5.8 2.7 5.1 1.9]</span>
<span class="co">##  [7.1 3.  5.9 2.1]</span>
<span class="co">##  [6.3 2.9 5.6 1.8]</span>
<span class="co">##  [6.5 3.  5.8 2.2]</span>
<span class="co">##  [7.6 3.  6.6 2.1]</span>
<span class="co">##  [4.9 2.5 4.5 1.7]</span>
<span class="co">##  [7.3 2.9 6.3 1.8]</span>
<span class="co">##  [6.7 2.5 5.8 1.8]</span>
<span class="co">##  [7.2 3.6 6.1 2.5]</span>
<span class="co">##  [6.5 3.2 5.1 2. ]</span>
<span class="co">##  [6.4 2.7 5.3 1.9]</span>
<span class="co">##  [6.8 3.  5.5 2.1]</span>
<span class="co">##  [5.7 2.5 5.  2. ]</span>
<span class="co">##  [5.8 2.8 5.1 2.4]</span>
<span class="co">##  [6.4 3.2 5.3 2.3]</span>
<span class="co">##  [6.5 3.  5.5 1.8]</span>
<span class="co">##  [7.7 3.8 6.7 2.2]</span>
<span class="co">##  [7.7 2.6 6.9 2.3]</span>
<span class="co">##  [6.  2.2 5.  1.5]</span>
<span class="co">##  [6.9 3.2 5.7 2.3]</span>
<span class="co">##  [5.6 2.8 4.9 2. ]</span>
<span class="co">##  [7.7 2.8 6.7 2. ]</span>
<span class="co">##  [6.3 2.7 4.9 1.8]</span>
<span class="co">##  [6.7 3.3 5.7 2.1]</span>
<span class="co">##  [7.2 3.2 6.  1.8]</span>
<span class="co">##  [6.2 2.8 4.8 1.8]</span>
<span class="co">##  [6.1 3.  4.9 1.8]</span>
<span class="co">##  [6.4 2.8 5.6 2.1]</span>
<span class="co">##  [7.2 3.  5.8 1.6]</span>
<span class="co">##  [7.4 2.8 6.1 1.9]</span>
<span class="co">##  [7.9 3.8 6.4 2. ]</span>
<span class="co">##  [6.4 2.8 5.6 2.2]</span>
<span class="co">##  [6.3 2.8 5.1 1.5]</span>
<span class="co">##  [6.1 2.6 5.6 1.4]</span>
<span class="co">##  [7.7 3.  6.1 2.3]</span>
<span class="co">##  [6.3 3.4 5.6 2.4]</span>
<span class="co">##  [6.4 3.1 5.5 1.8]</span>
<span class="co">##  [6.  3.  4.8 1.8]</span>
<span class="co">##  [6.9 3.1 5.4 2.1]</span>
<span class="co">##  [6.7 3.1 5.6 2.4]</span>
<span class="co">##  [6.9 3.1 5.1 2.3]</span>
<span class="co">##  [5.8 2.7 5.1 1.9]</span>
<span class="co">##  [6.8 3.2 5.9 2.3]</span>
<span class="co">##  [6.7 3.3 5.7 2.5]</span>
<span class="co">##  [6.7 3.  5.2 2.3]</span>
<span class="co">##  [6.3 2.5 5.  1.9]</span>
<span class="co">##  [6.5 3.  5.2 2. ]</span>
<span class="co">##  [6.2 3.4 5.4 2.3]</span>
<span class="co">##  [5.9 3.  5.1 1.8]]</span></code></pre></div>
<p><strong>data</strong>の各列は1種類の特徴量に対応するが、具体的になんという特徴量なのかは<strong>feature_names</strong>に入っている。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.feature_names)
<span class="co">## [&#39;sepal length (cm)&#39;, &#39;sepal width (cm)&#39;, &#39;petal length (cm)&#39;, &#39;petal width (cm)&#39;]</span></code></pre></div>
<p>NumPy配列の扱い方を簡単に。配列の形状(次元)はshapeで取得できる。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.data.shape)
<span class="co">## (150, 4)</span></code></pre></div>
<p>普通の配列みたいにスライスできる。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(iris_dataset.data[:<span class="dv">5</span>])
<span class="co">## [[5.1 3.5 1.4 0.2]</span>
<span class="co">##  [4.9 3.  1.4 0.2]</span>
<span class="co">##  [4.7 3.2 1.3 0.2]</span>
<span class="co">##  [4.6 3.1 1.5 0.2]</span>
<span class="co">##  [5.  3.6 1.4 0.2]]</span></code></pre></div>
</div>
<div id="-" class="section level3">
<h3><span class="header-section-number">1.6.2</span> 成功度合いの測定: 訓練データとテストデータ</h3>
<ul>
<li><strong>未知の測定値からアヤメの品種を予測する</strong>みたいなことやりたい。</li>
<li><strong>未知の入力</strong>に対する予測能力 is <strong>汎化能力</strong>。
<ul>
<li>こいつを最大化するのが目的。</li>
</ul></li>
<li>訓練に使ったデータはモデルの評価に使えない。
<ul>
<li>そのデータに対してモデルを最適化しているので、良い性能が出るのは当然。</li>
<li>一部だけ訓練に使って残りをテスト用に取っておけばよいのでは？ → <strong>ホールドアウト法</strong></li>
<li>訓練に使うデータセット: <strong>訓練データ</strong> or <strong>訓練セット</strong>。</li>
<li>テストに使うデータセット: <strong>テストデータ</strong> or <strong>テストセット</strong>。</li>
<li><strong>scikit-learn</strong>でホールドアウト法をやるなら<strong>model_selection.train_test_split</strong>。</li>
</ul></li>
<li><strong>scikit-learn</strong>的な慣習
<ul>
<li>(入力)データは<strong>X</strong>で表す</li>
<li>データラベル(=入力に対応する出力)は<strong>y</strong>で表す</li>
<li>入力は行列で出力はベクトルなので、<span class="math inline">\(f(\textbf{X}) = \textbf{y}\)</span>ということらしい。</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split
X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(
  iris_dataset.data, iris_dataset.target, random_state <span class="op">=</span> <span class="dv">0</span>
)</code></pre></div>
<ul>
<li>引数<strong>random_state</strong>は乱数種を固定する。再現性確保のため。</li>
<li>デフォルトで訓練:テスト=3:1に分解する。</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(X_train.shape)
<span class="co">## (112, 4)</span>
<span class="bu">print</span>(y_train.shape)
<span class="co">## (112,)</span>
<span class="bu">print</span>(X_test.shape)
<span class="co">## (38, 4)</span>
<span class="bu">print</span>(y_test.shape)
<span class="co">## (38,)</span></code></pre></div>
</div>
<div id="-" class="section level3">
<h3><span class="header-section-number">1.6.3</span> 最初にすべきこと: データを良く観察する</h3>
<ul>
<li>まずは散布図を作れ</li>
<li>多変量ならペアプロット(散布図行列)を作れ
<ul>
<li><strong>pandas</strong>にペアプロット作成関数があるので、<strong>pandas.DataFrame</strong>に変換して作業するとよい。</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">## DataFrameへの変換</span>
<span class="im">import</span> pandas <span class="im">as</span> pd
iris_dataframe <span class="op">=</span> pd.DataFrame(X_train, columns <span class="op">=</span> iris_dataset.feature_names)</code></pre></div>
<ul>
<li>注: テキストで指定しているオプションの大半は外観調整のためのものなので、なくてもいい。</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt
<span class="im">import</span> mglearn
<span class="co">## プロット</span>
<span class="co"># pandas.scatter_matrixはdeprecated</span>
pd.plotting.scatter_matrix( 
  iris_dataframe,    <span class="co"># データの指定</span>
  c <span class="op">=</span> y_train,       <span class="co"># データポイントの色を出力=品種に対応付ける</span>
  figsize <span class="op">=</span> (<span class="dv">15</span>, <span class="dv">15</span>),<span class="co"># 画像出力サイズの指定(なくてもいい)</span>
  marker <span class="op">=</span> <span class="st">&#39;o&#39;</span>,      <span class="co"># ポイントマーカーの指定(なくてもいい)</span>
  hist_kwds <span class="op">=</span> {<span class="st">&#39;bins&#39;</span>: <span class="dv">20</span>}, <span class="co"># ヒストグラムを作る関数に渡す引数の指定(とりあえずなくてもいい)</span>
  s <span class="op">=</span> <span class="dv">60</span>,            <span class="co"># データポイントのサイズ？(なくてもいい)</span>
  alpha <span class="op">=</span> .<span class="dv">8</span>,        <span class="co"># 透過度調整(なくてもいい)</span>
  cmap <span class="op">=</span> mglearn.cm3 <span class="co"># 配色設定(カラーマップ、なくてもいい)</span>
)
<span class="co">## 表示</span>
plt.show()</code></pre></div>
<p><img src="01_intro_files/figure-html/unnamed-chunk-13-1.png" width="1440" /></p>
</div>
<div id="-k-" class="section level3">
<h3><span class="header-section-number">1.6.4</span> 最初のモデル: k-最近傍法</h3>
<ul>
<li><strong>距離的に近いやつは仲間でいいんじゃね？</strong>に基づくアルゴリズム。</li>
<li><strong>scikit-learn</strong>のアルゴリズムを使うためには、アルゴリズムに対応するオブジェクトのインスタンスを生成する必要がある。</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier
knn <span class="op">=</span> KNeighborsClassifier(n_neighbors <span class="op">=</span> <span class="dv">1</span>) <span class="co"># インスタンス生成時にパラメータを指定できるものもある</span></code></pre></div>
<p>モデルに訓練セットを適合させるためには、<code>fit</code>メソッドを呼び出して訓練セットを渡すだけで良い。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">knn.fit(X_train, y_train)</code></pre></div>
</div>
<div id="section-1.6.5" class="section level3">
<h3><span class="header-section-number">1.6.5</span> 予測を行う</h3>
<p>予測は<code>predict</code>メソッドで行う。適当にデータを生成して予測してみよう。予測結果は符号化された値になるが、<code>iris_dataset.target_names</code>を使うと実際のラベル名が分かる。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> numpy <span class="im">as</span> np
X_new <span class="op">=</span> np.array([[<span class="dv">5</span>, <span class="fl">2.9</span>, <span class="dv">1</span>, <span class="fl">0.2</span>]])
<span class="bu">print</span>(knn.predict(X_new))
<span class="co">## [0]</span>
<span class="bu">print</span>(iris_dataset.target_names[knn.predict(X_new)])
<span class="co">## [&#39;setosa&#39;]</span></code></pre></div>
<ul>
<li>適当な数字から予測したから<strong>正解なのかどうか分からない！</strong></li>
<li>そのためのテストデータ。</li>
</ul>
</div>
<div id="section-1.6.6" class="section level3">
<h3><span class="header-section-number">1.6.6</span> モデルの評価</h3>
<ul>
<li><strong>精度 (accuracy)</strong>: テストデータのラベルを正しく判別できた割合。</li>
<li>テストデータを使って予測を行い、正解と同じラベルがどれだけあるか、をカウントする。</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># 予測</span>
y_pred <span class="op">=</span> knn.predict(X_test)
<span class="co"># 比較</span>
<span class="bu">print</span>(y_pred <span class="op">==</span> y_test)
<span class="co">## [ True  True  True  True  True  True  True  True  True  True  True  True</span>
<span class="co">##   True  True  True  True  True  True  True  True  True  True  True  True</span>
<span class="co">##   True  True  True  True  True  True  True  True  True  True  True  True</span>
<span class="co">##   True False]</span></code></pre></div>
<p>pythonは数値計算の際Trueは1、Falseは0として扱うので、<code>y_pred == y_test</code>の平均値がそのまま精度になる。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(np.mean(y_pred <span class="op">==</span> y_test))
<span class="co">## 0.9736842105263158</span></code></pre></div>
<p>予測から精度計算まで一発でやってくれるメソッドとして<code>score</code>もある。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(knn.score(X_test, y_test))
<span class="co">## 0.9736842105263158</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="section-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
