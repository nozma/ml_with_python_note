<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Pythonã§å§‹ã‚ã‚‹æ©Ÿæ¢°å­¦ç¿’ã®å­¦ç¿’</title>
  <meta name="description" content="Pythonã§å§‹ã‚ã‚‹æ©Ÿæ¢°å­¦ç¿’ã®å­¦ç¿’">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Pythonã§å§‹ã‚ã‚‹æ©Ÿæ¢°å­¦ç¿’ã®å­¦ç¿’" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Pythonã§å§‹ã‚ã‚‹æ©Ÿæ¢°å­¦ç¿’ã®å­¦ç¿’" />
  
  
  

<meta name="author" content="R. Ito">


<meta name="date" content="2018-03-08">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="section-2-2.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>ã¾ãˆãŠã</a><ul>
<li class="chapter" data-level="" data-path="e696b9e9879d.html"><a href="e696b9e9879d.html"><i class="fa fa-check"></i>æ–¹é‡</a></li>
<li class="chapter" data-level="" data-path="e59fb7e7ad86e792b0e5a283e381a8e3818b.html"><a href="e59fb7e7ad86e792b0e5a283e381a8e3818b.html"><i class="fa fa-check"></i>åŸ·ç­†ç’°å¢ƒã¨ã‹</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="section-1.html"><a href="section-1.html"><i class="fa fa-check"></i><b>1</b> ã¯ã˜ã‚ã«</a><ul>
<li class="chapter" data-level="1.1" data-path="section-1-1.html"><a href="section-1-1.html"><i class="fa fa-check"></i><b>1.1</b> ãªãœæ©Ÿæ¢°å­¦ç¿’ãªã®ã‹</a><ul>
<li class="chapter" data-level="1.1.1" data-path="section-1-1.html"><a href="section-1-1.html#section-1.1.1"><i class="fa fa-check"></i><b>1.1.1</b> æ©Ÿæ¢°å­¦ç¿’ã§è§£æ±ºå¯èƒ½ãªå•é¡Œ</a></li>
<li class="chapter" data-level="1.1.2" data-path="section-1-1.html"><a href="section-1-1.html#section-1.1.2"><i class="fa fa-check"></i><b>1.1.2</b> ã‚¿ã‚¹ã‚¯ã‚’çŸ¥ã‚Šã€ãƒ‡ãƒ¼ã‚¿ã‚’çŸ¥ã‚‹</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="python.html"><a href="python.html"><i class="fa fa-check"></i><b>1.2</b> ãªãœPythonãªã®ã‹ï¼Ÿ</a></li>
<li class="chapter" data-level="1.3" data-path="scikit-learn.html"><a href="scikit-learn.html"><i class="fa fa-check"></i><b>1.3</b> scikit-learn</a><ul>
<li class="chapter" data-level="1.3.1" data-path="scikit-learn.html"><a href="scikit-learn.html#section-1.3.1"><i class="fa fa-check"></i><b>1.3.1</b> ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="section-1-4.html"><a href="section-1-4.html"><i class="fa fa-check"></i><b>1.4</b> å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ãƒ„ãƒ¼ãƒ«</a></li>
<li class="chapter" data-level="1.5" data-path="python-2-vs-python-3.html"><a href="python-2-vs-python-3.html"><i class="fa fa-check"></i><b>1.5</b> Python 2 vs.Â Python 3</a></li>
<li class="chapter" data-level="1.6" data-path="-.html"><a href="-.html"><i class="fa fa-check"></i><b>1.6</b> æœ€åˆã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³: ã‚¢ã‚¤ãƒªã‚¹ã®ã‚¯ãƒ©ã‚¹åˆ†é¡</a><ul>
<li class="chapter" data-level="1.6.1" data-path="-.html"><a href="-.html#section-1.6.1"><i class="fa fa-check"></i><b>1.6.1</b> ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã‚€</a></li>
<li class="chapter" data-level="1.6.2" data-path="-.html"><a href="-.html#-"><i class="fa fa-check"></i><b>1.6.2</b> æˆåŠŸåº¦åˆã„ã®æ¸¬å®š: è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿</a></li>
<li class="chapter" data-level="1.6.3" data-path="-.html"><a href="-.html#-"><i class="fa fa-check"></i><b>1.6.3</b> æœ€åˆã«ã™ã¹ãã“ã¨: ãƒ‡ãƒ¼ã‚¿ã‚’è‰¯ãè¦³å¯Ÿã™ã‚‹</a></li>
<li class="chapter" data-level="1.6.4" data-path="-.html"><a href="-.html#-k-"><i class="fa fa-check"></i><b>1.6.4</b> æœ€åˆã®ãƒ¢ãƒ‡ãƒ«: k-æœ€è¿‘å‚æ³•</a></li>
<li class="chapter" data-level="1.6.5" data-path="-.html"><a href="-.html#section-1.6.5"><i class="fa fa-check"></i><b>1.6.5</b> äºˆæ¸¬ã‚’è¡Œã†</a></li>
<li class="chapter" data-level="1.6.6" data-path="-.html"><a href="-.html#section-1.6.6"><i class="fa fa-check"></i><b>1.6.6</b> ãƒ¢ãƒ‡ãƒ«ã®è©•ä¾¡</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="section-2.html"><a href="section-2.html"><i class="fa fa-check"></i><b>2</b> æ•™å¸«ã‚ã‚Šå­¦ç¿’</a><ul>
<li class="chapter" data-level="2.1" data-path="section-2-1.html"><a href="section-2-1.html"><i class="fa fa-check"></i><b>2.1</b> ã‚¯ãƒ©ã‚¹åˆ†é¡ã¨å›å¸°</a></li>
<li class="chapter" data-level="2.2" data-path="section-2-2.html"><a href="section-2-2.html"><i class="fa fa-check"></i><b>2.2</b> æ±åŒ–ã€éå‰°é©åˆã€é©åˆä¸è¶³</a><ul>
<li class="chapter" data-level="2.2.1" data-path="section-2-2.html"><a href="section-2-2.html#section-2.2.1"><i class="fa fa-check"></i><b>2.2.1</b> ãƒ¢ãƒ‡ãƒ«ã®è¤‡é›‘ã•ã¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®å¤§ãã•</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="section-2-3.html"><a href="section-2-3.html"><i class="fa fa-check"></i><b>2.3</b> æ•™å¸«ã‚ã‚Šæ©Ÿæ¢°å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </a><ul>
<li class="chapter" data-level="2.3.1" data-path="section-2-3.html"><a href="section-2-3.html#section-2.3.1"><i class="fa fa-check"></i><b>2.3.1</b> ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</a></li>
<li class="chapter" data-level="2.3.2" data-path="section-2-3.html"><a href="section-2-3.html#k-"><i class="fa fa-check"></i><b>2.3.2</b> <span class="math inline">\(k\)</span>-æœ€è¿‘å‚æ³•</a></li>
<li class="chapter" data-level="2.3.3" data-path="section-2-3.html"><a href="section-2-3.html#section-2.3.3"><i class="fa fa-check"></i><b>2.3.3</b> ç·šå½¢ãƒ¢ãƒ‡ãƒ«</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown">
Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Pythonã§å§‹ã‚ã‚‹æ©Ÿæ¢°å­¦ç¿’ã®å­¦ç¿’</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-2.3" class="section level2">
<h2><span class="header-section-number">2.3</span> æ•™å¸«ã‚ã‚Šæ©Ÿæ¢°å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </h2>
<div id="section-2.3.1" class="section level3">
<h3><span class="header-section-number">2.3.1</span> ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</h3>
<ul>
<li><strong>äººå·¥çš„ãªå˜ç´”ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</strong>ã¨ã€<strong>å®Ÿä¸–ç•Œã®å‰²ã¨è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</strong>ã‚’ä½¿ã†ã€‚</li>
</ul>
<div id="section-2.3.1.1" class="section level4">
<h4><span class="header-section-number">2.3.1.1</span> äººå·¥çš„ãªå˜ç´”ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</h4>
<p>å˜ç´”ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯<strong>mglearn</strong>ã§ç”Ÿæˆã™ã‚‹ã€‚</p>
<ul>
<li><strong>forge</strong>: <code>mglearn.datasets.make_forge()</code>ã§ç”Ÿæˆã™ã‚‹2ã‚¯ãƒ©ã‚¹åˆ†é¡å‘ã‘ãƒ‡ãƒ¼ã‚¿ã€‚
<ul>
<li>2ã¤ã®ç‰¹å¾´é‡ã¨1ã¤ã®2å€¤ç›®çš„å¤‰æ•°ã‚’ã‚‚ã¤ã€‚</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">X, y <span class="op">=</span> mglearn.datasets.make_forge()
mglearn.discrete_scatter(X[:, <span class="dv">0</span>], X[:, <span class="dv">1</span>], y)
plt.legend([<span class="st">&quot;Class 0&quot;</span>, <span class="st">&quot;Class 1&quot;</span>], loc <span class="op">=</span> <span class="dv">4</span>) <span class="co"># å‡¡ä¾‹</span>
plt.xlabel(<span class="st">&quot;ç¬¬1ç‰¹å¾´é‡&quot;</span>)
plt.ylabel(<span class="st">&quot;ç¬¬2ç‰¹å¾´é‡&quot;</span>)
plt.show()</code></pre></div>
<p><img src="02_supervised_learning_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">plt.close()</code></pre></div>
<ul>
<li><strong>wave</strong>: <code>mglearn.datasets.make_wave</code>ã§ç”Ÿæˆã™ã‚‹å›å¸°å‘ã‘ãƒ‡ãƒ¼ã‚¿ã€‚
<ul>
<li>1ã¤ã®ç‰¹å¾´é‡ã¨1ã¤ã®ç›®çš„å¤‰æ•°ã‚’æŒã¤ã€‚</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">X, y <span class="op">=</span> mglearn.datasets.make_wave(n_samples <span class="op">=</span> <span class="dv">40</span>)
plt.plot(X, y, <span class="st">&#39;o&#39;</span>)
plt.xlabel(<span class="st">&quot;ç‰¹å¾´é‡&quot;</span>)
plt.xlabel(<span class="st">&quot;ç›®çš„å¤‰æ•°&quot;</span>)
plt.show()</code></pre></div>
<p><img src="02_supervised_learning_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">plt.close()</code></pre></div>
</div>
<div id="section-2.3.1.2" class="section level4">
<h4><span class="header-section-number">2.3.1.2</span> å®Ÿãƒ‡ãƒ¼ã‚¿</h4>
<p>å®Ÿãƒ‡ãƒ¼ã‚¿ã¯<strong>scikit-learn</strong>ã«å…¥ã£ã¦ã‚‹ã‚‚ã®ã‚’ä½¿ã†ã€‚ç¬¬1ç« ã§ã‚‚èª¬æ˜ã—ãŸBunchã‚¯ãƒ©ã‚¹ã«ãªã£ã¦ã„ã‚‹ã€‚</p>
<ul>
<li><strong>cancer</strong>: ã‚¦ã‚£ã‚¹ã‚³ãƒ³ã‚·ãƒ³ä¹³ç™Œãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ
<ul>
<li>ç›®çš„å¤‰æ•°ã¯è‰¯æ€§(benign)ã¨æ‚ªæ€§(malignant)ã®2å€¤ã€‚</li>
<li>ç‰¹å¾´é‡ã¯30ã€‚</li>
<li>ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã¯569ç‚¹ã€‚</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_breast_cancer
cancer <span class="op">=</span> load_breast_cancer()
<span class="bu">print</span>(cancer.keys())
<span class="co">## dict_keys([&#39;data&#39;, &#39;target&#39;, &#39;target_names&#39;, &#39;DESCR&#39;, &#39;feature_names&#39;])</span>
<span class="bu">print</span>(cancer.data.shape)
<span class="co">## (569, 30)</span>
<span class="bu">print</span>(cancer.target_names)
<span class="co">## [&#39;malignant&#39; &#39;benign&#39;]</span>
<span class="bu">print</span>(np.bincount(cancer.target))
<span class="co">## [212 357]</span></code></pre></div>
<ul>
<li><strong>boston_housing</strong>: 1970å¹´ä»£ã®ãƒœã‚¹ãƒˆãƒ³è¿‘éƒŠã®ä½å®…ä¾¡æ ¼ã€‚
<ul>
<li>ä½å®…ä¾¡æ ¼ã®ä¸­å¤®å€¤ãŒç›®çš„å¤‰æ•°ã€‚</li>
<li>ç‰¹å¾´é‡ã¯13ã€‚</li>
<li>ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã¯506ç‚¹ã€‚</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_boston
boston <span class="op">=</span> load_boston()
<span class="bu">print</span>(boston.data.shape)
<span class="co">## (506, 13)</span>
<span class="bu">print</span>(boston.feature_names)
<span class="co">## [&#39;CRIM&#39; &#39;ZN&#39; &#39;INDUS&#39; &#39;CHAS&#39; &#39;NOX&#39; &#39;RM&#39; &#39;AGE&#39; &#39;DIS&#39; &#39;RAD&#39; &#39;TAX&#39; &#39;PTRATIO&#39;</span>
<span class="co">##  &#39;B&#39; &#39;LSTAT&#39;]</span></code></pre></div>
<ul>
<li>ç‰¹å¾´é‡åŒå£«ã®ç©ã‚’æ±‚ã‚ãŸã‚Šã—ã¦ã€æ–°ã—ã„ç‰¹å¾´é‡ã‚’å°å‡ºã™ã‚‹ã“ã¨ã‚’<strong>ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</strong>ã¨å‘¼ã¶ã€‚</li>
<li><strong>boston_housing</strong>ã«å¯¾ã—ã€é‡è¤‡ã‚ã‚Šã§2ã¤ã®ç‰¹å¾´é‡ã®ç©ã‚’æ±‚ã‚ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æ‹¡å¼µã‚’è©¦ã¿ã‚‹ã€‚
<ul>
<li>ä½œæ¥­ãŒé¢å€’ãªã®ã§æ—¢ã«æ‹¡å¼µã—ãŸã‚‚ã®ãŒ<code>mglearn.datasets.load_extended_boston()</code>ã§èª­ã¿è¾¼ã‚ã¾ã™ã€‚</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">X, y <span class="op">=</span> mglearn.datasets.load_extended_boston()
<span class="bu">print</span>(X.shape)
<span class="co">## (506, 104)</span></code></pre></div>
</div>
</div>
<div id="k-" class="section level3">
<h3><span class="header-section-number">2.3.2</span> <span class="math inline">\(k\)</span>-æœ€è¿‘å‚æ³•</h3>
<p>å‚™ãˆã‚ˆã†ã€‚</p>
</div>
<div id="section-2.3.3" class="section level3">
<h3><span class="header-section-number">2.3.3</span> ç·šå½¢ãƒ¢ãƒ‡ãƒ«</h3>
<div id="section-2.3.3.1" class="section level4">
<h4><span class="header-section-number">2.3.3.1</span> ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚‹å›å¸°</h4>
<p>ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚‹äºˆæ¸¬å¼ã¯â€¦</p>
<p><span class="math display">\[\hat{y} = w[0]\times x[0] + w[1]\times x[1] + ... + w[p]\times x[p] + b\]</span></p>
<ul>
<li><span class="math inline">\(\hat{y}\)</span>ã¯äºˆæ¸¬å€¤ã§ã€<span class="math inline">\(w\)</span>ã¨<span class="math inline">\(b\)</span>ã¯ãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‚<span class="math inline">\(x\)</span>ã¯ã‚ã‚‹ä¸€ã¤ã®ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã®ç‰¹å¾´é‡ã€‚</li>
<li>äºˆæ¸¬å€¤ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã‚’é©å½“ã«é‡ã¿ä»˜ã‘ã—ãŸã‚‚ã®ã€ã¨è¦‹ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚</li>
</ul>
<p><strong>wave</strong>ã«ç·šå½¢å›å¸°ã‚’é©ç”¨ã—ã¦ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ã¿ã‚ˆã†ã€‚</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">mglearn.plots.plot_linear_regression_wave()
<span class="co">## w[0]: 0.393906  b: -0.031804</span>
<span class="co">## </span>
<span class="co">## /Users/rito/myenv/lib/python3.6/site-packages/scipy/linalg/basic.py:1226: RuntimeWarning: internal gelsd driver lwork query error, required iwork dimension not returned. This is likely the result of LAPACK bug 0038, fixed in LAPACK 3.2.2 (released July 21, 2010). Falling back to &#39;gelss&#39; driver.</span>
<span class="co">##   warnings.warn(mesg, RuntimeWarning)</span>
plt.show()</code></pre></div>
<p><img src="02_supervised_learning_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
<p>ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã‚’åˆ©ç”¨ã—ãŸå›å¸°ã«ã¯ã„ã‚ã„ã‚ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒã‚ã£ã¦ã€ãã‚Œãã‚Œä»¥ä¸‹ã®ç‚¹ã§ç•°ãªã£ã¦ã„ã‚‹ã€‚</p>
<ul>
<li>ã©ã®ã‚ˆã†ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿<span class="math inline">\(w\)</span>ã¨<span class="math inline">\(b\)</span>ã‚’å­¦ç¿’ã™ã‚‹ã‹ã€‚</li>
<li>ãƒ¢ãƒ‡ãƒ«ã®è¤‡é›‘ã•ã‚’ã©ã®ã‚ˆã†ã«åˆ¶å¾¡ã™ã‚‹ã®ã‹ã€‚</li>
</ul>
</div>
<div id="section-2.3.3.2" class="section level4">
<h4><span class="header-section-number">2.3.3.2</span> ç·šå½¢å›å¸°(é€šå¸¸æœ€å°äºŒä¹—æ³•)</h4>
<ul>
<li>äºˆæ¸¬å€¤ã¨çœŸå€¤ã®<strong>å¹³å‡äºŒä¹—èª¤å·®</strong> (mean squared error) ã‚’æœ€å°ã«ã™ã‚‹ã‚ˆã†ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ±‚ã‚ã‚‹ã€‚</li>
<li>ç·šå½¢å›å¸°ã«ã¯è¤‡é›‘ã•ã‚’åˆ¶å¾¡ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒãªã„ã€‚ã§ããªã„ã€‚</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split
<span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression
X, y <span class="op">=</span> mglearn.datasets.make_wave(n_samples <span class="op">=</span> <span class="dv">60</span>)
X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, random_state <span class="op">=</span> <span class="dv">42</span>)
lr <span class="op">=</span> LinearRegression().fit(X_train, y_train)</code></pre></div>
<ul>
<li><span class="math inline">\(w\)</span>ã¯<strong>ä¿‚æ•°</strong> (coefficient)ã¨å‘¼ã°ã‚Œã€<code>coef_</code>ã«æ ¼ç´ã•ã‚Œã‚‹ã€‚</li>
<li><span class="math inline">\(b\)</span>ã¯<strong>åˆ‡ç‰‡</strong> (intercept)ã¨å‘¼ã°ã‚Œã€<code>intercept_</code>ã«æ ¼ç´ã•ã‚Œã‚‹ã€‚</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(lr.coef_)
<span class="co">## [0.39390555]</span>
<span class="bu">print</span>(lr.intercept_)
<span class="co">## -0.03180434302675976</span></code></pre></div>
<ul>
<li>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸå±æ€§ã«ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã‚’ä»˜ã‘ã‚‹ã®ã¯<strong>scikit-learn</strong>ã®æ…£ç¿’ã§ã‚ã‚‹ã€‚</li>
<li><code>coef_</code>ã¯ç‰¹å¾´é‡1ã¤ã«å¯¾ã—ã¦1ã¤ã®å€¤ã‚’ã‚‚ã¤NumPyé…åˆ—ã¨ãªã‚‹ã€‚</li>
<li>ç·šå½¢å›å¸°ã®æ€§èƒ½ã¯æ±ºå®šä¿‚æ•°<span class="math inline">\(R^2\)</span>ã¨ã—ã¦æ±‚ã‚ã‚‰ã‚Œã‚‹ã€‚</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(lr.score(X_train, y_train))
<span class="co">## 0.6700890315075756</span>
<span class="bu">print</span>(lr.score(X_test, y_test))
<span class="co">## 0.65933685968637</span></code></pre></div>
<p>ã“ã“ã§è¨“ç·´ã‚»ãƒƒãƒˆã¨ãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆã®<span class="math inline">\(R^2\)</span>ãŒã‚ã‚“ã¾ã‚Šé•ã‚ãªã„ã®ã¯ï¼ˆäºˆæ¸¬æ€§èƒ½ã¯ã¨ã‚‚ã‹ãï¼‰éå‰°é©åˆã—ã¦ã„ãªã„ã“ã¨ã‚’ç¤ºã—ã¦ã„ã‚‹ã€‚é€šå¸¸ã€ç‰¹å¾´é‡ãŒå¤šã„ã»ã©éå‰°é©åˆã®ãƒªã‚¹ã‚¯ãŒé«˜ã¾ã‚‹ã€‚æ‹¡å¼µã—ãŸ<strong>boston_housing</strong>ã§ç¢ºèªã—ã¦ã¿ã‚ˆã†ã€‚</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">X, y <span class="op">=</span> mglearn.datasets.load_extended_boston()
X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, random_state <span class="op">=</span> <span class="dv">0</span>)
lr <span class="op">=</span> LinearRegression().fit(X_train, y_train)</code></pre></div>
<p><span class="math inline">\(R^2\)</span>ã‚’è¨“ç·´ã‚»ãƒƒãƒˆã¨ãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆã§æ¯”è¼ƒã—ã¦ã¿ã‚ˆã†ã€‚</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(lr.score(X_train, y_train))
<span class="co">## 0.9523526436864234</span>
<span class="bu">print</span>(lr.score(X_test, y_test))
<span class="co">## 0.6057754892935417</span></code></pre></div>
<p>ä¸¡è€…ã«ä¹–é›¢ãŒè¦‹ã‚‰ã‚Œã‚‹ã®ã¯ã€éå‰°é©åˆã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚</p>
<p>ãƒ¢ãƒ‡ãƒ«ã®è¤‡é›‘ã•ã‚’åˆ¶å¾¡ã§ãã‚Œã°è‰¯ã„ã®ã ãŒã€ç·šå½¢å›å¸°ã«ã¯ãã®ãŸã‚ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒãªã„ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å°å…¥ã™ã‚‹æ–¹æ³•ã¨ã—ã¦<strong>ãƒªãƒƒã‚¸å›å¸°</strong>ãŒã‚ã‚‹ã€‚</p>
</div>
<div id="section-2.3.3.3" class="section level4">
<h4><span class="header-section-number">2.3.3.3</span> ãƒªãƒƒã‚¸å›å¸°</h4>
<ul>
<li>ä¿‚æ•°ãŒå¤šã„ã‹ã‚‰ãƒ¢ãƒ‡ãƒ«ãŒè¤‡é›‘ã«ãªã‚‹ã€‚</li>
<li>ä¿‚æ•°ãŒ0ï¼ãã®ä¿‚æ•°ã‚’è€ƒæ…®ã—ãªã„ã€‚</li>
<li>ä¿‚æ•°ãŒå°ã•ã‘ã‚Œã°ãƒ¢ãƒ‡ãƒ«ã¯å˜ç´”ã«ãªã‚‹ã®ã§ã¯ğŸ¤”
<ul>
<li>æ¥µç«¯ãªè©±ä¿‚æ•°ãŒå…¨éƒ¨ã‚¼ãƒ­ãªã‚‰å…¥åŠ›ã«é–¢ã‚ã‚‰ãšä¸€å®šã®å€¤(å¹³å‡ã¨ã‹)ã‚’å‡ºåŠ›ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã«ãªã‚‹ã€‚</li>
</ul></li>
<li>ä¿‚æ•°ãƒ™ã‚¯ãƒˆãƒ«ã®é•·ã•ã‚’æœ€å°åŒ–ã—ã‚ˆã†ï¼â†’ãƒªãƒƒã‚¸å›å¸°</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge
ridge <span class="op">=</span> Ridge().fit(X_train, y_train) <span class="co"># ãƒ‡ãƒ¼ã‚¿ã¯æ‹¡å¼µBoston housingã®ã¾ã¾</span>
<span class="bu">print</span>(ridge.score(X_train, y_train))
<span class="co">## 0.8860578560395833</span>
<span class="bu">print</span>(ridge.score(X_test, y_test))
<span class="co">## 0.7527139600306942</span></code></pre></div>
<ul>
<li>è¨“ç·´ã‚»ãƒƒãƒˆã¸ã®äºˆæ¸¬èƒ½åŠ›ãŒä¸‹ãŒã£ãŸã‘ã©ãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆã¸ã®äºˆæ¸¬èƒ½åŠ›ãŒä¸ŠãŒã£ãŸï¼
<ul>
<li>ãƒ¢ãƒ‡ãƒ«ã‚’å˜ç´”ã«ã™ã‚‹ã“ã¨ã§æ±åŒ–èƒ½åŠ›ãŒä¸ŠãŒã£ã¦ã„ã‚‹ã€‚</li>
</ul></li>
<li>ãƒªãƒƒã‚¸å›å¸°ã«ãŠã‘ã‚‹ãƒ¢ãƒ‡ãƒ«ã®å˜ç´”ã•ã‚’åˆ¶å¾¡ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: <span class="math inline">\(\alpha\)</span>
<ul>
<li>å¤§ãã„ã»ã©åˆ¶ç´„ãŒå¼·ã„ = ãƒ¢ãƒ‡ãƒ«ãŒå˜ç´”ã«ãªã‚‹</li>
<li>sklearnã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯1.0</li>
<li>ä½•ãŒè‰¯ã„ã‹ã¯ãƒ‡ãƒ¼ã‚¿æ¬¡ç¬¬ã§ã€è‡ªå‹•çš„ã«ã¯èª¿æ•´ã•ã‚Œãªã„ï¼ˆå¾Œã§å¤šåˆ†ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°æ–¹æ³•ãŒå‡ºã¦æ¥ã‚‹ï¼‰ã€‚</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">### alphaã‚’10å€ã«ã—ã¦ã¿ã‚‹ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆæ™‚ã«æŒ‡å®š</span>
ridge10 <span class="op">=</span> Ridge(alpha <span class="op">=</span> <span class="dv">10</span>).fit(X_train, y_train)
<span class="bu">print</span>(ridge10.score(X_train, y_train))
<span class="co">## 0.7883461511233252</span>
<span class="bu">print</span>(ridge10.score(X_test, y_test))
<span class="co">### alphaã‚’0.1å€ã«ã—ã¦ã¿ã‚‹ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆæ™‚ã«æŒ‡å®š</span>
<span class="co">## 0.6358967327447734</span>
ridge01 <span class="op">=</span> Ridge(alpha <span class="op">=</span> .<span class="dv">1</span>).fit(X_train, y_train)
<span class="bu">print</span>(ridge01.score(X_train, y_train))
<span class="co">## 0.9285782082010738</span>
<span class="bu">print</span>(ridge01.score(X_test, y_test))
<span class="co">## 0.7717933688844855</span></code></pre></div>
<p><span class="math inline">\(\alpha\)</span>ã®å¤§ãã•ã¨ä¿‚æ•°ã®é–¢ä¿‚ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ã¿ã‚‹ã€‚<span class="math inline">\(\alpha\)</span>ãŒå¤§ãã„ã»ã©ä¿‚æ•°ã®çµ¶å¯¾å€¤ã¯å°ã•ããªã‚‹ã¯ãšâ€¦</p>
<p>TODO:ãƒ©ãƒ™ãƒ«ä½ç½®ã®èª¿æ•´æ–¹æ³•ã‚’èª¿ã¹ã‚‹</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">plt.plot(ridge.coef_, <span class="st">&#39;s&#39;</span>, label<span class="op">=</span><span class="st">&quot;Ridge alpha=1&quot;</span>)
plt.plot(ridge10.coef_, <span class="st">&#39;^&#39;</span>, label<span class="op">=</span><span class="st">&quot;Ridge alpha=10&quot;</span>)
plt.plot(ridge01.coef_, <span class="st">&#39;v&#39;</span>, label<span class="op">=</span><span class="st">&quot;Ridge alpha=0.1&quot;</span>)
plt.plot(lr.coef_, <span class="st">&#39;o&#39;</span>, label<span class="op">=</span><span class="st">&quot;LinearRegression&quot;</span>)
plt.xlabel(<span class="st">&quot;ä¿‚æ•°ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹&quot;</span>)
plt.ylabel(<span class="st">&quot;ä¿‚æ•°ã®å€¤&quot;</span>)
plt.hlines(<span class="dv">0</span>, <span class="dv">0</span>, <span class="bu">len</span>(lr.coef_))
plt.ylim(<span class="op">-</span><span class="dv">25</span>, <span class="dv">25</span>)
plt.legend()
plt.show()</code></pre></div>
<p><img src="02_supervised_learning_files/figure-html/unnamed-chunk-15-1.png" width="768" /></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">plt.close()</code></pre></div>
<ul>
<li>ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã‚’å¢—ã‚„ã—ã¦ã„ãã¨ã‚¹ã‚³ã‚¢ã¯ã©ã®ã‚ˆã†ã«å¤‰åŒ–ã™ã‚‹ã‹ï¼Ÿ
<ul>
<li><strong>å­¦ç¿’æ›²ç·š</strong> (learning curve)</li>
</ul></li>
</ul>
<p>TODO:å‡¡ä¾‹ãƒ©ãƒ™ãƒ«ã®æ›¸ãæ›ãˆæ–¹ã‚’èª¿ã¹ã‚‹</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">mglearn.plots.plot_ridge_n_samples()
plt.xlabel(<span class="st">&quot;è¨“ç·´ã‚»ãƒƒãƒˆã®ã‚µã‚¤ã‚º&quot;</span>)
plt.ylabel(<span class="st">&quot;ã‚¹ã‚³ã‚¢(RÂ²)&quot;</span>)
plt.show()</code></pre></div>
<p><img src="02_supervised_learning_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">plt.close()</code></pre></div>

</div>
</div>
</div>
<!-- </div> -->
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://nozma.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="section-2-2.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/nozma/ml_with_python_note/edit/master/02_supervised_learning.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
